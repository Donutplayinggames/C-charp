using System;
using System.IO;
using System.Collections.Generic;
using System.Text;
using System.Linq;
using Newtonsoft.Json;
using Streamer.bot.Plugin.Interface;
using Newtonsoft.Json.Linq;

public class CPHInline
{
    string basePath = AppDomain.CurrentDomain.BaseDirectory;
    int refreshSeconds = 15;
    int liveDisplayEvents = 200;

    // Add the shortening method here
    private string ShortenEventSource(string source)
    {
        if (string.IsNullOrEmpty(source)) return source;
        
        // Find the first lowercase→uppercase transition
        for (int i = 1; i < source.Length; i++)
        {
            if (char.IsLower(source[i - 1]) && char.IsUpper(source[i]))
            {
                return source.Substring(0, i);
            }
        }
        
        return source; // No transition found, return original
    }

    public bool Execute()
    {
        CPH.TryGetArg("__source", out EventType trigger);
        CPH.TryGetArg("eventSource", out string eventSource);

        string htmlFolderPath = $"{basePath}Donuts logs\\MultiPlatform";
        Directory.CreateDirectory(htmlFolderPath);

        // No filtering - log all platforms (Twitch, YouTube, Kick, etc.)
        string today = DateTime.Now.ToString("yyyy-MM-dd");

        // Archive paths
        string archivePath = $"{htmlFolderPath}\\Archives\\{today}_events.json";
        Directory.CreateDirectory($"{htmlFolderPath}\\Archives");

        // Create EventData
        EventData newEvent = new EventData
        {
            Timestamp = DateTime.Now,
            Source = trigger.ToString(),
            Details = GetEventDetails(trigger),
            RawData = "" // Not used - kept for backwards compatibility
        };

        SaveToArchive(archivePath, newEvent);

        // Live events
        string liveJsonPath = $"{htmlFolderPath}\\live_events.json";
        List<EventData> liveEvents = LoadEvents(liveJsonPath);
        liveEvents.Add(newEvent);
        if (liveEvents.Count > liveDisplayEvents)
            liveEvents.RemoveAt(0);
        SaveEvents(liveJsonPath, liveEvents);

        // Generate HTML
        GenerateLiveHTML($"{htmlFolderPath}\\live.html", liveEvents);
        GenerateIndexHTML($"{htmlFolderPath}\\index.html", htmlFolderPath);

        List<EventData> todayEvents = LoadEvents(archivePath);
        GenerateArchiveHTML($"{htmlFolderPath}\\Archives\\{today}.html", todayEvents, today);

        return true;
    }

    public void SaveToArchive(string archivePath, EventData newEvent)
    {
        List<EventData> events = LoadEvents(archivePath);
        events.Add(newEvent);
        SaveEvents(archivePath, events);
    }

    public List<EventData> LoadEvents(string path)
    {
        if (!File.Exists(path)) return new List<EventData>();
        try
        {
            string json = File.ReadAllText(path);
            return JsonConvert.DeserializeObject<List<EventData>>(json) ?? new List<EventData>();
        }
        catch { return new List<EventData>(); }
    }

    public void SaveEvents(string path, List<EventData> events)
    {
        string json = JsonConvert.SerializeObject(events, Formatting.Indented);
        File.WriteAllText(path, json);
    }

    public string GetEventDetails(EventType trigger)
    {
        switch (trigger)
        {
            // ==================== Application ====================
            case EventType.ApplicationActionAdded:
                CPH.TryGetArg("id", out string ApplicationActionAddedid);
                CPH.TryGetArg("name", out string ApplicationActionAddedname);
                CPH.TryGetArg("group", out string ApplicationActionAddedgroup);
                CPH.TryGetArg("enabled", out bool ApplicationActionAddedenabled);
                CPH.TryGetArg("random", out bool ApplicationActionAddedrandom);
                CPH.TryGetArg("concurrent", out bool ApplicationActionAddedconcurrent);
                CPH.TryGetArg("alwaysRun", out bool ApplicationActionAddedalwaysRun);
                CPH.TryGetArg("excludeFromHistory", out bool ApplicationActionAddedexcludeFromHistory);
                CPH.TryGetArg("excludeFromPending", out bool ApplicationActionAddedexcludeFromPending);
                return $"<strong>No description provided</strong>";

            case EventType.ApplicationActionDeleted:
                CPH.TryGetArg("id", out string ApplicationActionDeletedid);
                CPH.TryGetArg("name", out string ApplicationActionDeletedname);
                CPH.TryGetArg("group", out string ApplicationActionDeletedgroup);
                CPH.TryGetArg("enabled", out bool ApplicationActionDeletedenabled);
                CPH.TryGetArg("random", out bool ApplicationActionDeletedrandom);
                CPH.TryGetArg("concurrent", out bool ApplicationActionDeletedconcurrent);
                CPH.TryGetArg("alwaysRun", out bool ApplicationActionDeletedalwaysRun);
                CPH.TryGetArg("excludeFromHistory", out bool ApplicationActionDeletedexcludeFromHistory);
                CPH.TryGetArg("excludeFromPending", out bool ApplicationActionDeletedexcludeFromPending);
                return $"<strong>No description provided</strong>";

            case EventType.ApplicationActionUpdated:
                CPH.TryGetArg("id", out string ApplicationActionUpdatedid);
                CPH.TryGetArg("name", out string ApplicationActionUpdatedname);
                CPH.TryGetArg("group", out string ApplicationActionUpdatedgroup);
                CPH.TryGetArg("enabled", out bool ApplicationActionUpdatedenabled);
                CPH.TryGetArg("random", out bool ApplicationActionUpdatedrandom);
                CPH.TryGetArg("concurrent", out bool ApplicationActionUpdatedconcurrent);
                CPH.TryGetArg("alwaysRun", out bool ApplicationActionUpdatedalwaysRun);
                CPH.TryGetArg("excludeFromHistory", out bool ApplicationActionUpdatedexcludeFromHistory);
                CPH.TryGetArg("excludeFromPending", out bool ApplicationActionUpdatedexcludeFromPending);
                return $"<strong>No description provided</strong>";

            case EventType.ApplicationCommandAdded:
                CPH.TryGetArg("id", out string ApplicationCommandAddedid);
                CPH.TryGetArg("name", out string ApplicationCommandAddedname);
                CPH.TryGetArg("group", out string ApplicationCommandAddedgroup);
                CPH.TryGetArg("enabled", out bool ApplicationCommandAddedenabled);
                return $"<strong>No description provided</strong>";

            case EventType.ApplicationCommandDeleted:
                CPH.TryGetArg("id", out string ApplicationCommandDeletedid);
                CPH.TryGetArg("name", out string ApplicationCommandDeletedname);
                CPH.TryGetArg("group", out string ApplicationCommandDeletedgroup);
                CPH.TryGetArg("enabled", out bool ApplicationCommandDeletedenabled);
                return $"<strong>No description provided</strong>";

            case EventType.ApplicationCommandUpdated:
                CPH.TryGetArg("id", out string ApplicationCommandUpdatedid);
                CPH.TryGetArg("name", out string ApplicationCommandUpdatedname);
                CPH.TryGetArg("group", out string ApplicationCommandUpdatedgroup);
                CPH.TryGetArg("enabled", out bool ApplicationCommandUpdatedenabled);
                return $"<strong>No description provided</strong>";

            case EventType.ApplicationImport:
                CPH.TryGetArg("importType", out string ApplicationImportType);
                CPH.TryGetArg("fileName", out string ApplicationImportFileName);
                CPH.TryGetArg("itemCount", out int ApplicationImportItemCount);
                CPH.TryGetArg("success", out bool ApplicationImportSuccess);

                string statusText = ApplicationImportSuccess ? "✅ Success" : "❌ Failed";
                string details = $"<strong>Application Import</strong> • Type: {ApplicationImportType ?? "Unknown"}";

                if (!string.IsNullOrEmpty(ApplicationImportFileName))
                    details += $" • File: {ApplicationImportFileName}";
                if (ApplicationImportItemCount > 0) // FIXED: Variable name was wrong
                    details += $" • Items: {ApplicationImportItemCount}";
                details += $" • {statusText}";

                return details;

            // ==================== Chat Window ====================
            case EventType.ChatWindowAction:
                CPH.TryGetArg("receivedEvent", out string receivedEvent);
                CPH.TryGetArg("eventSource", out string chatWindowEventSource);
                return $"<strong>Chat Window Action</strong> • Event: {receivedEvent}";

            // ==================== Command ========================
            case EventType.CommandCooldown:
                CPH.TryGetArg("triggerCategory", out string CommandCoolDownTriggerCategory);                                                        /* The category of the trigger which executed the action */
                CPH.TryGetArg("command", out string CommandCoolDownCommand);
                CPH.TryGetArg("commandSource", out string CommandCoolDownCommandSource);
                CPH.TryGetArg("commandType", out string CommandCoolDownCommandType);
                CPH.TryGetArg("msgId", out string CommandCoolDownMsgId);
                CPH.TryGetArg("isTest", out bool CommandCoolDownIsTest);
                CPH.TryGetArg("commandId", out Guid CommandCoolDownCommandId);
                CPH.TryGetArg("runningActionId", out Guid CommandCoolDownRunningActionId);                                                          /* The unique ID of this running action instance within the queue */
                CPH.TryGetArg("actionQueuedAt", out DateTime CommandCoolDownActionQueuedAt);                                                        /* The timestamp of when action was queued */
                CPH.TryGetArg("triggerId", out Guid CommandCoolDownTriggerId);                                                                      /* The unique id of the trigger with executed the action */
                CPH.TryGetArg("triggerName", out string CommandCoolDownTriggerName);                                                                /* The name of the trigger which executed the action */
                CPH.TryGetArg("actionId", out Guid CommandCoolDownActionId);                                                                        /* The unique ID of the action being executed */
                CPH.TryGetArg("actionName", out Guid CommandCoolDownActionName);                                                                    /* The name of the action being executed */
                CPH.TryGetArg("eventSource", out Guid CommandCoolDownEventSource);                                                                  /* The service of the event which triggered the action.*/
                CPH.TryGetArg("cooldownLeft", out int CommandCooldowncooldownLeft);
                CPH.TryGetArg("globalCooldownLeft", out int CommandCooldownGlobalCoolDownLeft);
                CPH.TryGetArg("user", out object CommandCooldownuser);
                CPH.TryGetArg("id", out string CommandCooldownid);
                CPH.TryGetArg("name", out string CommandCooldownname);
                CPH.TryGetArg("userCooldownLeft", out int CommandCooldownuserCooldownLeft);
                CPH.TryGetArg("message", out string CommandCooldownmessage);

                    // Build the base message
                string CommandCooldownresult = $"Command <strong>{CommandCoolDownCommand}</strong> is in cooldown for {CommandCooldownGlobalCoolDownLeft} seconds";

                // Only append if it's a test
                if (CommandCoolDownIsTest)
                {
                CommandCooldownresult += ". Test trigger: True";
                }

                return CommandCooldownresult;  


            case EventType.CommandTriggered:
                CPH.TryGetArg("user", out string CommandTriggereduser);
                CPH.TryGetArg("userName", out string CommandTriggeredUserName);
                CPH.TryGetArg("userId", out string CommandTriggeredUserID);
                CPH.TryGetArg("triggerCategory", out string CommandTriggeredTriggerCategory);                                                       /* The category of the trigger which executed the action */
                CPH.TryGetArg("rawInput", out string CommandTriggeredRawInput); 
                CPH.TryGetArg("command", out string CommandTriggeredCommands);
                CPH.TryGetArg("commandSource", out string CommandTriggeredCommandSource);
                CPH.TryGetArg("commandType", out string CommandTriggeredCommandType);
                CPH.TryGetArg("msgId", out string CommandTriggeredMsgID);
                CPH.TryGetArg("counter", out int CommandTriggeredCounter);
                CPH.TryGetArg("userCounter", out int CommandTriggereduserCounter);
                CPH.TryGetArg("isTest", out bool CommandTriggeredIsTest);
                CPH.TryGetArg("broadcasterIsOnboarded", out bool CommandTriggeredbroadcasterIsOnboarded);
                CPH.TryGetArg("id", out string CommandTriggeredid);
                CPH.TryGetArg("name", out string CommandTriggeredname);
                CPH.TryGetArg("cooldownLeft", out int CommandTriggeredcooldownLeft);
                CPH.TryGetArg("globalCooldownLeft", out int CommandTriggeredglobalCooldownLeft);
                CPH.TryGetArg("userCooldownLeft", out int CommandTriggereduserCooldownLeft);
                CPH.TryGetArg("message", out string CommandTriggeredmessage);

                                    // Build the base message
                string CommandTriggeredresult = $"Command <strong>{CommandTriggeredCommands}</strong> Triggered by {CommandTriggeredUserName}";

                // Only append if it's a test
                if (CommandTriggeredIsTest)
                {
                CommandTriggeredresult += ". Test trigger: True";
                }

                return CommandTriggeredresult; 

            // ==================== CrowdControl ========================
            case EventType.CrowdControlCoinExchange:
                CPH.TryGetArg("isTest", out string CrowdControlCoinExchangeIsTest);
                CPH.TryGetArg("TriggerName", out string CrowdControlCoinExchangeTriggername);
                CPH.TryGetArg("eventsource", out string CrowdControlCoinExchangeEventsource);
                return $"<strong>No description provided</strong>";

            case EventType.CrowdControlEffectFailure:
                CPH.TryGetArg("isTest", out string CrowdControlEffectFailureIsTest);
                CPH.TryGetArg("TriggerName", out string CrowdControlEffectFailureTriggerName);
                CPH.TryGetArg("eventsource", out string CrowdControlEffectFailureEventSource);
                CPH.TryGetArg("triggerCategory", out string CrowdControlEffectFailureTriggerCategoty);                                              /* The category of the trigger which executed the action */
                CPH.TryGetArg("effect.effectID", out string CrowdControlEffectFailureEffectID);
                CPH.TryGetArg("effect.name", out string CrowdControlEffectFailureEffectName);
                CPH.TryGetArg("effect.price", out int CrowdControlEffectFailureEffectPrice); /*price*/
                CPH.TryGetArg("game.name", out string CrowdControlEffectFailureGameName);  /*gamename*/
                CPH.TryGetArg("gamePack.name", out string CrowdControlEffectFailureGamePackName);
                CPH.TryGetArg("gamePack.platform", out string CrowdControlEffectFailureGamePackPlatform);
                CPH.TryGetArg("requester.name", out string CrowdControlEffectFailureRequesterName);
                CPH.TryGetArg("effect.category[0]", out string CrowdControlEffectFailureEffectCategory);
                return $"{CrowdControlEffectFailureRequesterName} failed <strong>{CrowdControlEffectFailureEffectName}</strong> for {CrowdControlEffectFailureGameName} (price {CrowdControlEffectFailureEffectPrice}) (Category {CrowdControlEffectFailureEffectCategory})";

                return $"<strong>No description provided</strong>";

            case EventType.CrowdControlEffectRequest:
                CPH.TryGetArg("isTest", out string CrowdControlEffectRequestIsTest);
                CPH.TryGetArg("TriggerName", out string CrowdControlEffectRequestTriggername);
                CPH.TryGetArg("eventsource", out string CrowdControlEffectRequestEventsource);
                CPH.TryGetArg("triggerCategory", out string CrowdControlEffectRequestTriggerCategoty);                                              /* The category of the trigger which executed the action */
                CPH.TryGetArg("effect.effectID", out string CrowdControlEffectRequestEffectID);
                CPH.TryGetArg("effect.name", out string CrowdControlEffectRequestEffectName);
                CPH.TryGetArg("effect.price", out int CrowdControlEffectRequestEffectPrice); /*price*/
                CPH.TryGetArg("game.name", out string CrowdControlEffectRequestGameName);  /*gamename*/
                CPH.TryGetArg("gamePack.name", out string CrowdControlEffectRequestGamePackName);
                CPH.TryGetArg("gamePack.platform", out string CrowdControlEffectRequestGamePackPlatform);
                CPH.TryGetArg("requester.name", out string CrowdControlEffectRequestRequesterName);
                CPH.TryGetArg("effect.category[0]", out string CrowdControlEffectRequestEffectCategory);
                return $"{CrowdControlEffectRequestRequesterName} redeem <strong>{CrowdControlEffectRequestEffectName}</strong> for {CrowdControlEffectRequestGameName} (price {CrowdControlEffectRequestEffectPrice}) (Category {CrowdControlEffectRequestEffectCategory})";

            case EventType.CrowdControlEffectSuccess:
               CPH.TryGetArg("isTest", out string CrowdControlEffectSuccessIsTest);
                CPH.TryGetArg("TriggerName", out string CrowdControlEffectSuccessTriggername);
                CPH.TryGetArg("eventsource", out string CrowdControlEffectSuccessEventsource);
                CPH.TryGetArg("triggerCategory", out string CrowdControlEffectSuccessTriggerCategoty);                                              /* The category of the trigger which executed the action */
                CPH.TryGetArg("effect.effectID", out string CrowdControlEffectSuccessEffectID);
                CPH.TryGetArg("effect.name", out string CrowdControlEffectSuccessEffectName);
                CPH.TryGetArg("effect.price", out int CrowdControlEffectSuccessEffectPrice); /*price*/
                CPH.TryGetArg("game.name", out string CrowdControlEffectSuccessGameName);  /*gamename*/
                CPH.TryGetArg("gamePack.name", out string CrowdControlEffectSuccessGamePackName);
                CPH.TryGetArg("gamePack.platform", out string CrowdControlEffectSuccessGamePackPlatform);
                CPH.TryGetArg("requester.name", out string CrowdControlEffectSuccessRequesterName);
                CPH.TryGetArg("effect.category[0]", out string CrowdControlEffectSuccessEffectCategory);
                return $"{CrowdControlEffectSuccessRequesterName} redeem <strong>{CrowdControlEffectSuccessEffectName}</strong> for {CrowdControlEffectSuccessGameName} (price {CrowdControlEffectSuccessEffectPrice}) (Category {CrowdControlEffectSuccessEffectCategory})";


            case EventType.CrowdControlGameSessionEnd:
                CPH.TryGetArg("isTest", out string CrowdControlGameSessionEndIsTest);
                CPH.TryGetArg("triggerCategory", out string CrowdControlGameSessionEndtriggerCategory);                                             /* The category of the trigger which executed the action */
                CPH.TryGetArg("triggerName", out string CrowdControlGameSessionEndTriggername);                                                     /* The name of the trigger which executed the action */
                CPH.TryGetArg("eventsource", out string CrowdControlGameSessionEndEventsource);
                return $"CrowdControl <strong>{CrowdControlGameSessionEndTriggername}</strong>";

            case EventType.CrowdControlGameSessionStart:
                CPH.TryGetArg("isTest", out string CrowdControlGameSessionStartIsTest);
                CPH.TryGetArg("TriggerName", out string CrowdControlGameSessionStartTriggerName);
                CPH.TryGetArg("eventsource", out string CrowdControlGameSessionStartEventSource);
                CPH.TryGetArg("gameSessionId", out string CrowdControlGameSessionStartGameSessionId);
                return $"Crowdcontrol <strong>{CrowdControlGameSessionStartTriggerName}</strong>";

            case EventType.CrowdControlTimedEffectStarted:
                CPH.TryGetArg("isTest", out string CrowdControlTimedEffectStartedIsTest);
                CPH.TryGetArg("TriggerName", out string CrowdControlTimedEffectStartedTriggername);
                CPH.TryGetArg("eventsource", out string CrowdControlTimedEffectStartedEventsource);
                return $"<strong>No description provided</strong>";

            case EventType.CrowdControlTimedEffectUpdated:
                CPH.TryGetArg("isTest", out string CrowdControlTimedEffectUpdatedIsTest);
                CPH.TryGetArg("TriggerName", out string CrowdControlTimedEffectUpdatedTriggername);
                CPH.TryGetArg("eventsource", out string CrowdControlTimedEffectUpdatedEventsource);
                return $"<strong>No description provided</strong>";

            // ==================== DonorDrive ========================
            case EventType.DonorDriveDonation:
                CPH.TryGetArg("isTest", out string DonorDriveDonationIsTest);
                return $"<strong>No description provided</strong>";

            case EventType.DonorDriveIncentive:
                CPH.TryGetArg("isTest", out string DonorDriveIncentiveIsTest);
                return $"<strong>No description provided</strong>";

            case EventType.DonorDriveProfileUpdated:
                CPH.TryGetArg("isTest", out string DonorDriveProfileUpdatedIsTest);
                return $"<strong>No description provided</strong>";

            // ==================== Elgato Camera Hub ========================
            case EventType.ElgatoCameraHubConnected:
                CPH.TryGetArg("isTest", out string ElgatoCameraHubConnectedisTest);
                CPH.TryGetArg("triggerId", out string ElgatoCameraHubConnectedTriggerId);                                                           /* The unique id of the trigger with executed the action */
                CPH.TryGetArg("triggerName", out string ElgatoCameraHubConnectedTriggerName);                                                       /* The name of the trigger which executed the action */
                CPH.TryGetArg("triggerCategory", out string ElgatoCameraHubConnectedTriggerCategory);                                               /* The category of the trigger which executed the action */
                CPH.TryGetArg("eventSource", out string ElgatoCameraHubConnectedEventSource);                                                       /* The service of the event which triggered the action.*/
                return $"<strong>No description provided</strong>";

            case EventType.ElgatoCameraHubDisconnected:
                CPH.TryGetArg("isTest", out string ElgatoCameraHubDisconnectedisTest);
                CPH.TryGetArg("triggerName", out string ElgatoCameraHubDisconnectedtrigger);                                                        /* The name of the trigger which executed the action */
                CPH.TryGetArg("triggerCategory", out string ElgatoCameraHubDisconnectedCategory);                                                   /* The category of the trigger which executed the action */
                CPH.TryGetArg("eventSource", out string ElgatoCameraHubDisconnectedEventSource);                                                    /* The service of the event which triggered the action.*/
                return $"<strong>No description provided</strong>";

            case EventType.ElgatoCameraHubPrompterAutoScrollChapterDisabled:
                CPH.TryGetArg("isTest", out string ElgatoCameraHubPrompterAutoScrollChapterDisabledisTest);
                return $"<strong>No description provided</strong>";

            case EventType.ElgatoCameraHubPrompterAutoScrollChapterEnabled:
                CPH.TryGetArg("isTest", out string ElgatoCameraHubPrompterAutoScrollChapterEnabledisTest);
                return $"<strong>No description provided</strong>";

            case EventType.ElgatoCameraHubPrompterAutoScrollDisabled:
                CPH.TryGetArg("isTest", out string ElgatoCameraHubPrompterAutoScrollDisabledisTest);
                return $"<strong>No description provided</strong>";

            case EventType.ElgatoCameraHubPrompterAutoScrollEnabled:
                CPH.TryGetArg("isTest", out string ElgatoCameraHubPrompterAutoScrollEnabledisTest);
                return $"<strong>No description provided</strong>";

            case EventType.ElgatoCameraHubPrompterBackgroundColorChanged:
                CPH.TryGetArg("isTest", out string ElgatoCameraHubPrompterBackgroundColorChangedisTest);
                return $"<strong>No description provided</strong>";

            case EventType.ElgatoCameraHubPrompterBrightnessChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubPrompterChannelsChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubPrompterConnected:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubPrompterContrastChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubPrompterCrosshairColorChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubPrompterCrosshairDisabled:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubPrompterCrosshairEnabled:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubPrompterCrosshairImageChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubPrompterDisconnected:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubPrompterFontChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubPrompterFontColorChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubPrompterFontSizeChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubPrompterHorizontalMarginChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubPrompterLineSpacingChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubPrompterModeChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubPrompterOpacityChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubPrompterScrollSpeedChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubPrompterSelectedChannelChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubPrompterSelectedChapterChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubPrompterSelectedScriptChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubPrompterVerticalMarginChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubSelectedWebcamChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubTiltChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubWebcamActivated:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubWebcamAntiFlickerChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubWebcamARLensChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubWebcamAutoExposureDisabled:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubWebcamAutoExposureEnabled:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubWebcamAutoFocusDisabled:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubWebcamAutoFocusEnabled:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubWebcamAutoWhiteBalanceDisabled:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubWebcamAutoWhiteBalanceEnabled:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubWebcamBitrateChanged:
                return $"<strong>No description provided</strong>";

            case EventType.ElgatoCameraHubWebcamBrightnessChanged:
                CPH.TryGetArg("webcamName", out string BrightnessChangedWebcamName);
                CPH.TryGetArg("newValue", out int BrightnessChangedNewValue);
                CPH.TryGetArg("oldValue", out int BrightnessChangedOldValue);
                return $"Webcam **{BrightnessChangedWebcamName}** brightness changed from **{BrightnessChangedOldValue}** to **{BrightnessChangedNewValue}**";

            case EventType.ElgatoCameraHubWebcamConnected:
                CPH.TryGetArg("webcamName", out string WebcamConnectedName);
                return $"Webcam **{WebcamConnectedName}** connected to Elgato Camera Hub.";

            case EventType.ElgatoCameraHubWebcamContrastChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubWebcamDeactivated:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubWebcamDeviceOrientationChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubWebcamExposureAutoLockDisabled:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubWebcamFlashDisabled:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubWebcamFlashEnabled:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubWebcamFlipped:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubWebcamFocusChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubWebcamISOChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubWebcamLiveISOChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubWebcamLiveShutterSpeedChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubWebcamLiveWhiteBalanceChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubWebcamLiveWhiteBalanceTintChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubWebcamMirrored:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubWebcamNoiseReductionDisabled:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubWebcamNoiseReductionEnabled:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubWebcamOverscanChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubWebcamPanChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubWebcamrDisconnected:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubWebcamSaturationChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubWebcamSharpnessChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubWebcamShutterSpeedChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubWebcamSnapshotTaken:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubWebcamWhiteBalanceChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubWebcamWhiteBalanceTintChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoCameraHubWebcamZoomChanged:
                return $"<strong>No description provided</strong>";

            // ==================== Elgato Stream Deck ========================
            case EventType.StreamDeckAction:
                CPH.TryGetArg("device", out string StreamDeckActionDevice);
                CPH.TryGetArg("page", out string StreamDeckActionPage);
                CPH.TryGetArg("keyId", out int StreamDeckActionKeyId);
                CPH.TryGetArg("state", out int StreamDeckActionState); // 0=Down, 1=Up
                CPH.TryGetArg("isTest", out bool StreamDeckActionIsTest);
                string actionType = StreamDeckActionState == 0 ? "Pressed" : "Released";
                string streamDeckResult = $"Stream Deck action **{actionType}** on Key **{StreamDeckActionKeyId}** (Device: {StreamDeckActionDevice}, Page: {StreamDeckActionPage})";
                if (StreamDeckActionIsTest)
                {
                    streamDeckResult += ". Test trigger: True";
                }
                return streamDeckResult;

                return $"<strong>No description provided</strong>";
            case EventType.StreamDeckConnected:
                return $"<strong>No description provided</strong>";
            case EventType.StreamDeckDisconnected:
                return $"<strong>No description provided</strong>";
            case EventType.StreamDeckInfo:
                return $"<strong>No description provided</strong>";

            // ==================== Elgato Wave Link ========================
            case EventType.ElgatoWaveLinkConnected:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoWaveLinkDisconnected:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoWaveLinkFilterAdded:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoWaveLinkFilterBypassStateChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoWaveLinkFilterChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoWaveLinkFilterDeleted:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoWaveLinkInputLevelMeterChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoWaveLinkInputMuteChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoWaveLinkInputNameChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoWaveLinkInputVolumeChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoWaveLinkMicrophoneBalanceChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoWaveLinkMicrophoneGainChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoWaveLinkMicrophoneMuteChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoWaveLinkMicrophoneOutputVolumeChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoWaveLinkMicrophoneSettingChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoWaveLinkOutputLevelMeterChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoWaveLinkOutputMuteChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoWaveLinkOutputSwitched:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoWaveLinkOutputVolumeChanged:
                return $"<strong>No description provided</strong>";
            case EventType.ElgatoWaveLinkSelectedOutputChanged:
                return $"<strong>No description provided</strong>";

            // ==================== File ========================
            case EventType.FileTailChanged:
                CPH.TryGetArg("triggerCategory", out string FileTailChangedTriggerCategory);                                                        /* The category of the trigger which executed the action */
                CPH.TryGetArg("isTest", out bool FileTailChangedIsTest);                                                                            /*False/True */
                CPH.TryGetArg("runningActionId", out Guid FileTailChangedRunningActionId);                                                          /* The unique ID of this running action instance within the queue */
                CPH.TryGetArg("actionQueuedAt", out DateTime FileTailChangedActionQueuedAt);                                                        /* The timestamp of when action was queued */
                CPH.TryGetArg("triggerId", out Guid FileTailChangedTriggerId);                                                                      /* The unique id of the trigger with executed the action */
                CPH.TryGetArg("triggerName", out string FileTailChangedTriggerName);                                                                /* The name of the trigger which executed the action */
                CPH.TryGetArg("actionId", out Guid FileTailChangedActionId);                                                                        /* The unique ID of the action being executed */
                CPH.TryGetArg("actionName", out string FileTailChangedActionName);                                                                  /* The name of the action being executed */
                CPH.TryGetArg("eventSource", out string FileTailChangedEventSource);                                                                /* The service of the event which triggered the action.*/
                CPH.TryGetArg("fileName", out string FileTailChangedFileName);                                                                      /*yeet.mp3*/
                CPH.TryGetArg("line", out string FileTailChangedLine);                                                                              /*This is a test line*/
                CPH.TryGetArg("fullPath", out string FileTailChangedfullPath);
                CPH.TryGetArg("oldFullPath", out string FileTailChangedoldFullPath);
                CPH.TryGetArg("oldFileName", out string FileTailChangedoldFileName);


				// Build the base message
    			string FileTailChangedresult = $"<strong> File {FileTailChangedFileName}</strong> on {FileTailChangedLine}";

    			// Only append if it's a test
    			if (FileTailChangedIsTest)
    			{
        		FileTailChangedresult += ". Test trigger: True";  // FIXED: Changed from 'result' to 'CommandCooldownresult'
    			}

    			return FileTailChangedresult;

            case EventType.FileWatcherChanged:
                CPH.TryGetArg("fileName", out string FileWatcherChangedfileName);
                CPH.TryGetArg("lines", out string [] FileWatcherChangedlines);
				CPH.TryGetArg("fileSize", out int  FileWatcherChangedFileSize);
				CPH.TryGetArg("triggerName", out string FileWatcherChangedTriggerName);                                                             /* The name of the trigger which executed the action */
				CPH.TryGetArg("isTest", out bool FileWatcherChangedIsTest);                                                                         /*if test tigger is False our true */
				CPH.TryGetArg("changeType", out string FileWatcherChangedChangeType);                                                               /*The type of change (Changed, Created, Deleted)*/
				CPH.TryGetArg("triggerCategory", out string FileWatcherChangedCreated);                                                             /* The category of the trigger which executed the action */
				CPH.TryGetArg("actionId", out Guid FileWatcherChangedActionId);                                                                     /* The unique ID of the action being executed */
				CPH.TryGetArg("fullPath", out string FileWatcherChangedFullPath);                                                                   /*The Full path to the file*/
				CPH.TryGetArg("watcherFilter", out string FileWatcherChangedWatcherFilter);                                                         /*settings.json*/
                CPH.TryGetArg("watcherFolder", out string FileWatcherChangedWatcherFolder);                                                         /*F:\Streamersbot\data*/
                string firstLine = FileWatcherChangedlines.FirstOrDefault();
                if (!string.IsNullOrEmpty(firstLine))
                {
                    return $"File **{FileWatcherChangedfileName}** was changed. The first line of the change is: **{firstLine}**";
                }
                else
                {
                    return $"File **{FileWatcherChangedfileName}** was changed, but no new lines were read.";
                }

            case EventType.FileWatcherCreated:
                CPH.TryGetArg("triggerCategory", out string FileWatcherCreated);                                                                    /* The category of the trigger which executed the action */
                CPH.TryGetArg("isTest", out bool FileWatcherCreatedIsTest);                                                                         /*if test tigger is False our true */
                CPH.TryGetArg("runningActionId", out Guid FileWatcherCreatedRunningActionID);                                                       /* The unique ID of this running action instance within the queue */
                CPH.TryGetArg("actionQueuedAt", out DateTime FileWatcherCreatedActionQueuedAt);                                                     /* The timestamp of when action was queued */
                CPH.TryGetArg("triggerId", out Guid FileWatcherCreatedTriggerID);                                                                   /* The unique id of the trigger with executed the action */
                CPH.TryGetArg("triggerName", out string FileWatcherCreatedTriggerName);                                                             /* The name of the trigger which executed the action */
                CPH.TryGetArg("actionId", out Guid FileWatcherCreatedActionId);                                                                     /* The unique ID of the action being executed */
                CPH.TryGetArg("actionName", out string FileWatcherCreatedActionName);                                                               /* The name of the action being executed */
                CPH.TryGetArg("eventSource", out string FileWatcherCreatedEventSource);                                                             /* The service of the event which triggered the action.*/
                CPH.TryGetArg("fullPath", out string FileWatcherCreatedFullPath);                                                                   /*The Full path to the file*/
                CPH.TryGetArg("fileName", out string FileWatcherCreatedFileName);                                                                   /*The file name with extension*/
                CPH.TryGetArg("changeType", out string FileWatcherCreatedChangeType);                                                               /*The type of change (Changed, Created, Deleted)*/
                CPH.TryGetArg("watcherFilter", out string FileWatcherCreatedWatcherFilter);                                                         /*settings.json*/
                CPH.TryGetArg("watcherFolder", out string FileWatcherCreatedWatcherFolder);                                                         /*F:\Streamersbot\data*/
                CPH.TryGetArg("empty", out string FileWatcherCreatedEmpty);                                                                         /*if the file is now empty*/
                CPH.TryGetArg("lines", out string FileWatcherCreatedLines);                                                                         /*the numer of lines in the file*/
                CPH.TryGetArg("line", out int FileWatcherCreatedLine);                                                                              /*the specific line of the file, 0 based index, 0 is the first line*/
                CPH.TryGetArg("lineEscaped#", out string FileWatcherCreatedLineEscaped);                                                            /*the line escaped for use in a url Query*/
                CPH.TryGetArg("fileSize", out int FileWatcherCreatedFileSize);  
                return $"<strong>No description provided</strong>";

            case EventType.FileWatcherDeleted:
			    CPH.TryGetArg("triggerCategory", out string FileWatcherDeletedTrigggerCategory);                                                    /* The category of the trigger which executed the action */
    			CPH.TryGetArg("isTest", out bool FileWatcherDeletedIsTest);                                                                         /*Trigger test False/True*/
    			CPH.TryGetArg("runningActionId", out Guid FileWatcherDeletedRunningActionId);                                                       /* The unique ID of this running action instance within the queue */
    			CPH.TryGetArg("actionQueuedAt", out DateTime FileWatcherDeletedActionQueuedAt);                                                     /* The timestamp of when action was queued */
    			CPH.TryGetArg("triggerId", out Guid FileWatcherDeletedTriggerId);                                                                   /* The unique id of the trigger with executed the action */
    			CPH.TryGetArg("triggerName", out string FileWatcherDeletedTriggerName);                                                             /* The name of the trigger which executed the action */
    			CPH.TryGetArg("actionId", out Guid FileWatcherDeletedActionId);                                                                     /* The unique ID of the action being executed */
    			CPH.TryGetArg("actionName", out string FileWatcherDeletedActionName);                                                               /* The name of the action being executed */
				CPH.TryGetArg("eventSource", out string FileWatcherDeletedEventSource);                                                             /* The service of the event which triggered the action.*/
                CPH.TryGetArg("fullPath", out string FileWatcherDeletedFullPath);                                                                   /*The Full path to the file*/
                CPH.TryGetArg("fileName", out string FileWatcherDeletedFileName);                                                                   /*The file name with extension*/
    			CPH.TryGetArg("changeType", out string FileWatcherDeletedChangeType);                                                               /*The type of change (Changed, Created, Deleted)*/
    			CPH.TryGetArg("watcherFilter", out string FileWatcherDeletedWatcherFilter);                                                         /*settings.json*/
                CPH.TryGetArg("watcherFolder", out string FileWatcherDeletedWatcherFolder);                                                         /*F:\Streamersbot\data*/
                return $"<strong>No description provided</strong>";

            case EventType.FileWatcherRenamed:
                CPH.TryGetArg("triggerCategory", out string FileWatcherRenamedTrigggerCategory);                                                    /* The category of the trigger which executed the action */
                CPH.TryGetArg("isTest", out bool FileWatcherRenamedIsTest);                                                                         /*Trigger test False/True*/
                CPH.TryGetArg("runningActionId", out Guid FileWatcherRenamedRunningActionId);                                                       /* The unique ID of this running action instance within the queue */
                CPH.TryGetArg("actionQueuedAt", out DateTime FileWatcherRenamedActionQueuedAt);                                                     /* The timestamp of when action was queued */
                CPH.TryGetArg("triggerId", out Guid FileWatcherRenamedTriggerId);                                                                   /* The unique id of the trigger with executed the action */
                CPH.TryGetArg("triggerName", out string FileWatcherRenamedTriggerName);                                                             /* The name of the trigger which executed the action */
                CPH.TryGetArg("actionId", out Guid FileWatcherRenamedActionId);                                                                     /* The unique ID of the action being executed */
                CPH.TryGetArg("actionName", out string FileWatcherRenamedActionName);                                                               /* The name of the action being executed */
                CPH.TryGetArg("eventSource", out string FileWatcherRenamedEventSource);                                                             /* The service of the event which triggered the action.*/
                CPH.TryGetArg("changeType", out string FileWatcherRenamedChangeType);                                                               /*The type of change (Changed, Created, Deleted)*/
                CPH.TryGetArg("fullPath", out string FileWatcherRenamedFullPath);                                                                   /*Path where it is stored*/
                CPH.TryGetArg("fileName", out string FileWatcherRenamedFileName);                                                                   /*the file name*/
                CPH.TryGetArg("oldFullPath", out string FileWatcherRenamedoldFullPath);                                                             /*Old path where the file is located*/
                CPH.TryGetArg("oldFileName", out string FileWatcherRenamedoldFileName);                                                             /*old file name after rename it*/
                CPH.TryGetArg("watcherFilter", out string FileWatcherRenamedWatcherFilter);                                                         /*settings.json*/
                CPH.TryGetArg("watcherFolder", out string FileWatcherRenamedWatcherFolder);                                                         /*F:\Streamersbot\data*/
                return $"<strong>No description provided</strong>";

            // ==================== Fourthwall ========================
            case EventType.FourthwallDonation:
                CPH.TryGetArg("donationId", out string FourthwallDonationID);
                CPH.TryGetArg("createdAt", out DateTime FourthwallDonationCreatedAt);
                CPH.TryGetArg("shopId", out string FourthwallDonationShopId);
                CPH.TryGetArg("username", out string FourthwallDonationUsername);                                                                   /* supporter username */
                CPH.TryGetArg("email", out string FourthwallDonationEmail);
                CPH.TryGetArg("message", out string FourthwallDonationMessage);                                                                     /* message from supporter */
                CPH.TryGetArg("amount", out decimal FourthwallDonationAmount);                                                                      /* 41 */
                CPH.TryGetArg("currency", out string FourthwallDonationCurrency);                                                                   /* USD/EUR */
                CPH.TryGetArg("status", out string FourthwallDonationStatus);                                                                       /* COMPLETED */
                   
                return $"{FourthwallDonationUsername} Donate <strong>{FourthwallDonationCurrency} {FourthwallDonationAmount}</strong> • Status: {FourthwallDonationStatus}"
                    + (string.IsNullOrEmpty(FourthwallDonationMessage) ? "" : $" • Message: {FourthwallDonationMessage}");

            case EventType.FourthwallGiftDrawEnded:
                return $"<strong>No description provided</strong>";
            case EventType.FourthwallGiftDrawStarted:
                return $"<strong>No description provided</strong>";
            case EventType.FourthwallGiftPurchase:
                return $"<strong>No description provided</strong>";
            case EventType.FourthwallNewsletterSubscribed:
                return $"<strong>No description provided</strong>";
            case EventType.FourthwallOrderPlaced:
                return $"<strong>No description provided</strong>";
            case EventType.FourthwallOrderUpdated:
                return $"<strong>No description provided</strong>";
            case EventType.FourthwallProductCreated:
                return $"<strong>No description provided</strong>";
            case EventType.FourthwallProductUpdated:
                return $"<strong>No description provided</strong>";
            case EventType.FourthwallSubscriptionChanged:
                return $"<strong>No description provided</strong>";
            case EventType.FourthwallSubscriptionExpired:
                return $"<strong>No description provided</strong>";
            case EventType.FourthwallSubscriptionPurchased:
                return $"<strong>No description provided</strong>";
            case EventType.FourthwallThankYouSent:
                return $"<strong>No description provided</strong>";

            // ==================== Global Variable ========================

            case EventType.GlobalVariableCreated:
                CPH.TryGetArg("triggerCategory", out string GlobalVariableCreatedTriggerCategoty);                                                  /* The category of the trigger which executed the action */
                CPH.TryGetArg("isTest", out bool GlobalVariableCreatedIsTest);                                                                      /*Is test trigger False/True*/
                CPH.TryGetArg("runningActionId", out Guid GlobalVariableCreatedRunningActionId);                                                    /* The unique ID of this running action instance within the queue */
                CPH.TryGetArg("actionQueuedAt", out DateTime GlobalVariableCreatedActionQueuedAt);                                                  /* The timestamp of when action was queued */
                CPH.TryGetArg("triggerId", out Guid GlobalVariableCreatedTriggerId);                                                                /* The unique id of the trigger with executed the action */
                CPH.TryGetArg("triggerName", out string GlobalVariableCreatedTriggerName);                                                          /* The name of the trigger which executed the action */
                CPH.TryGetArg("actionId", out Guid GlobalVariableCreatedActionID);                                                                  /* The unique ID of the action being executed */
                CPH.TryGetArg("actionName", out string GlobalVariableCreatedActionName);                                                            /* The name of the action being executed */
                CPH.TryGetArg("eventSource", out string GlobalVariableCreatedEventSource);                                                          /* The service of the event which triggered the action.*/
                CPH.TryGetArg("global.lastWrite", out DateTime GlobalVariableCreatedGlobalLastWrite);                                               /*2025-11-22 15:10:30*/
                CPH.TryGetArg("global.name", out string GlobalVariableCreatedGlobalName);                                                           /*streamerBot*/
                CPH.TryGetArg("global.persisted", out bool GlobalVariableCreatedGlobalPersisted);                                                   /*True*/
                CPH.TryGetArg("global.value", out int GlobalVariableCreatedGlobalValue);                                                            /*2*/
                return $"{GlobalVariableCreatedTriggerName} with name: <strong>{GlobalVariableCreatedGlobalName}</strong> set to value <strong>{GlobalVariableCreatedGlobalValue}</strong>.";

            case EventType.GlobalVariableDeleted:
                CPH.TryGetArg("triggerCategory", out string GlobalVariableDeletedTriggerCategoty);                                                  /* The category of the trigger which executed the action */
                CPH.TryGetArg("isTest", out bool GlobalVariableDeletedIsTest);                                                                      /* Is test trigger False/True */
                CPH.TryGetArg("runningActionId", out Guid GlobalVariableDeletedRunningActionId);                                                    /* The unique ID of this running action instance within the queue */
                CPH.TryGetArg("actionQueuedAt", out DateTime GlobalVariableDeletedActionQueuedAt);                                                  /* The timestamp of when action was queued */
                CPH.TryGetArg("triggerId", out Guid GlobalVariableDeletedTriggerId);                                                                /* The unique id of the trigger with executed the action */
                CPH.TryGetArg("triggerName", out string GlobalVariableDeletedTriggerName);                                                          /* The name of the trigger which executed the action */
                CPH.TryGetArg("actionId", out Guid GlobalVariableDeletedActionID);                                                                  /* The unique ID of the action being executed */
                CPH.TryGetArg("actionName", out string GlobalVariableDeletedActionName);                                                            /* The name of the action being executed */
                CPH.TryGetArg("eventSource", out string GlobalVariableDeletedEventSource);                                                          /* The service of the event which triggered the action.*/
                CPH.TryGetArg("global.lastWrite", out DateTime GlobalVariableDeletedGlobalLastWrite);                                               /* 2025-11-22 15:10:30 */
                CPH.TryGetArg("global.name", out string GlobalVariableDeletedGlobalName);                                                           /* streamerBot */
                CPH.TryGetArg("global.persisted", out bool GlobalVariableDeletedGlobalPersisted);                                                   /* True */
                CPH.TryGetArg("global.value", out int GlobalVariableDeletedGlobalValue);                                                            /* 2 */
                return $"{GlobalVariableDeletedTriggerName} with name: <strong>{GlobalVariableDeletedGlobalName}</strong> with value <strong>{GlobalVariableDeletedGlobalValue}</strong>.";

            case EventType.GlobalVariableUpdated:
                CPH.TryGetArg("triggerCategory", out string GlobalVariableUpdatedTriggerCategoty);                                                  /* The category of the trigger which executed the action */
                CPH.TryGetArg("isTest", out bool GlobalVariableUpdatedIsTest);                                                                      /* Is test trigger False/True */
                CPH.TryGetArg("runningActionId", out Guid GlobalVariableUpdatedRunningActionId);                                                    /* The unique ID of this running action instance within the queue */
                CPH.TryGetArg("actionQueuedAt", out DateTime GlobalVariableUpdatedActionQueuedAt);                                                  /* The timestamp of when action was queued */
                CPH.TryGetArg("triggerId", out Guid GlobalVariableUpdatedTriggerId);                                                                /* The unique id of the trigger with executed the action */
                CPH.TryGetArg("triggerName", out string GlobalVariableUpdatedTriggerName);                                                          /* The name of the trigger which executed the action */
                CPH.TryGetArg("actionId", out Guid GlobalVariableUpdatedActionID);                                                                  /* The unique ID of the action being executed */
                CPH.TryGetArg("actionName", out string GlobalVariableUpdatedActionName);                                                            /* The name of the action being executed */
                CPH.TryGetArg("eventSource", out string GlobalVariableUpdatedEventSource);                                                          /* The service of the event which triggered the action.*/
                CPH.TryGetArg("global.lastWrite", out DateTime GlobalVariableUpdatedGlobalLastWrite);                                               /* 2025-11-22 15:10:30 */
                CPH.TryGetArg("global.name", out string GlobalVariableUpdatedGlobalName);                                                           /* streamerBot */
                CPH.TryGetArg("global.persisted", out bool GlobalVariableUpdatedGlobalPersisted);                                                   /* True */
                CPH.TryGetArg("global.value", out int GlobalVariableUpdatedGlobalValue);                                                            /* 2 */
                CPH.TryGetArg("global.newValue", out string GlobalVariableUpdatedGlobalNewValue);                                                   /* streamerBot */
                CPH.TryGetArg("global.oldValue", out string GlobalVariableUpdatedGlobalOldValue);                                                   /* streamerBot */
                return $"{GlobalVariableUpdatedTriggerName} with name: <strong>{GlobalVariableUpdatedGlobalName}</strong> changed from <strong>{GlobalVariableUpdatedGlobalOldValue}</strong>. to <strong>{GlobalVariableUpdatedGlobalNewValue}</strong>";


            case EventType.GroupAdded:
                CPH.TryGetArg("triggerCategory", out string GroupAddedTriggerCategoty);                                                             /* The category of the trigger which executed the action */
                CPH.TryGetArg("isTest", out bool GroupAddedIsTest);                                                                                 /* Is test trigger False/True */
                CPH.TryGetArg("runningActionId", out Guid GroupAddedRunningActionId);                                                               /* The unique ID of this running action instance within the queue */
                CPH.TryGetArg("actionQueuedAt", out DateTime GroupAddedActionQueuedAt);                                                             /* The timestamp of when action was queued */
                CPH.TryGetArg("triggerId", out Guid GroupAddedTriggerId);                                                                           /* The unique id of the trigger with executed the action */
                CPH.TryGetArg("triggerName", out string GroupAddedTriggerName);                                                                     /* The name of the trigger which executed the action */
                CPH.TryGetArg("actionId", out Guid GroupAddedActionID);                                                                             /* The unique ID of the action being executed */
                CPH.TryGetArg("actionName", out string GroupAddedActionName);                                                                       /* The name of the action being executed */
                CPH.TryGetArg("eventSource", out string GroupAddedEventSource);                                                                     /* The service of the event which triggered the action.*/
                CPH.TryGetArg("groupId", out string GroupAddedGroupId);
                CPH.TryGetArg("groupName", out string GroupAddedGroupName);
                CPH.TryGetArg("groupBots", out bool GroupAddedGroupBots); 
                return $"GroupName **{GroupAddedGroupName}** has been created. Action: '{GroupAddedActionName}'.(GroupId: {GroupAddedGroupId}) (Bots: {GroupAddedGroupBots})";

            case EventType.GroupCleared:
                CPH.TryGetArg("triggerCategory", out string GroupClearedTriggerCategoty);                                                           /* The category of the trigger which executed the action */
                CPH.TryGetArg("isTest", out bool GroupClearedIsTest);                                                                               /* Is test trigger False/True */
                CPH.TryGetArg("runningActionId", out Guid GroupClearedRunningActionId);                                                             /* The unique ID of this running action instance within the queue */
                CPH.TryGetArg("actionQueuedAt", out DateTime GroupClearedActionQueuedAt);                                                           /* The timestamp of when action was queued */
                CPH.TryGetArg("triggerId", out Guid GroupClearedTriggerId);                                                                         /* The unique id of the trigger with executed the action */
                CPH.TryGetArg("triggerName", out string GroupClearedTriggerName);                                                                   /* The name of the trigger which executed the action */
                CPH.TryGetArg("actionId", out Guid GroupClearedActionID);                                                                           /* The unique ID of the action being executed */
                CPH.TryGetArg("actionName", out string GroupClearedActionName);                                                                     /* The name of the action being executed */
                CPH.TryGetArg("eventSource", out string GroupClearedEventSource);                                                                   /* The service of the event which triggered the action.*/
                CPH.TryGetArg("groupId", out string GroupClearedGroupId);
                CPH.TryGetArg("groupName", out string GroupClearedGroupName);
                CPH.TryGetArg("groupBots", out bool GroupClearedGroupBots); 
                return $"GroupName **{GroupClearedGroupName}** has been cleared. Action: '{GroupClearedActionName}'.(GroupId: {GroupClearedGroupId}) (Bots: {GroupClearedGroupBots})";

            case EventType.GroupRemoved:
                CPH.TryGetArg("triggerCategory", out string GroupRemovedTriggerCategoty);                                                           /* The category of the trigger which executed the action */
                CPH.TryGetArg("isTest", out bool GroupRemovedIsTest);                                                                               /* Is test trigger False/True */
                CPH.TryGetArg("runningActionId", out Guid GroupRemovedRunningActionId);                                                             /* The unique ID of this running action instance within the queue */
                CPH.TryGetArg("actionQueuedAt", out DateTime GroupRemovedActionQueuedAt);                                                           /* The timestamp of when action was queued */
                CPH.TryGetArg("triggerId", out Guid GroupRemovedTriggerId);                                                                         /* The unique id of the trigger with executed the action */
                CPH.TryGetArg("triggerName", out string GroupRemovedTriggerName);                                                                   /* The name of the trigger which executed the action */
                CPH.TryGetArg("actionId", out Guid GroupRemovedActionID);                                                                           /* The unique ID of the action being executed */
                CPH.TryGetArg("actionName", out string GroupRemovedActionName);                                                                     /* The name of the action being executed */
                CPH.TryGetArg("eventSource", out string GroupRemovedEventSource);                                                                   /* The service of the event which triggered the action.*/
                CPH.TryGetArg("groupId", out string GroupRemovedGroupId);
                CPH.TryGetArg("groupName", out string GroupRemovedGroupName);
                CPH.TryGetArg("groupBots", out bool GroupRemovedGroupBots); 
                return $"GroupName **{GroupRemovedGroupName}** has been Removed. Action: '{GroupRemovedActionName}'.(GroupId: {GroupRemovedGroupId}) (Bots: {GroupRemovedGroupBots})";

                case EventType.GroupUsersAdded:
                {
                CPH.TryGetArg("groupId", out string GroupUsersAddedGroupId);
                CPH.TryGetArg("groupName", out string GroupUsersAddedGroupName);
                CPH.TryGetArg("count", out int GroupUsersAddedCount);
                CPH.TryGetArg("groupBots", out bool GroupUsersAddedGroupBots);
                CPH.TryGetArg("users", out object[]  GroupUsersAddedUsersObj);

                string GroupUsersAddedfirstUser = null;
                if (GroupUsersAddedUsersObj != null && GroupUsersAddedUsersObj.Length > 0)
                    {
                    // Convert to JObject to avoid using 'dynamic'
                    var user = JObject.FromObject(GroupUsersAddedUsersObj[0]);
                    GroupUsersAddedfirstUser = (string)user["display"] ?? (string)user["name"] ?? (string)user["id"];
                    }   

                    if (!string.IsNullOrEmpty(GroupUsersAddedfirstUser))
                    {
                    return $"Group **{GroupUsersAddedGroupName}** (ID: {GroupUsersAddedGroupId}) had {GroupUsersAddedCount} users added. First user: **{GroupUsersAddedfirstUser}**";
                    }
                    else
                    {
                    return $"Group **{GroupUsersAddedGroupName}** (ID: {GroupUsersAddedGroupId}) had {GroupUsersAddedCount} users added, but no user details were retrieved.";
                    }
                }

            case EventType.GroupUsersRemoved:
                {
                CPH.TryGetArg("groupId", out string GroupUsersRemovedGroupId);
                CPH.TryGetArg("groupName", out string GroupUsersRemovedGroupName);
                CPH.TryGetArg("count", out int GroupUsersRemovedCount);
                CPH.TryGetArg("groupBots", out bool GroupUsersRemovedGroupBots);
                CPH.TryGetArg("users", out object[]  GroupUsersRemovedUsersObj);

                string GroupUsersRemovedfirstUser = null;
                if (GroupUsersRemovedUsersObj != null && GroupUsersRemovedUsersObj.Length > 0)
                    {
                    // Convert to JObject to avoid using 'dynamic'
                    var user = JObject.FromObject(GroupUsersRemovedUsersObj[0]);
                    GroupUsersRemovedfirstUser = (string)user["display"] ?? (string)user["name"] ?? (string)user["id"];
                    }   

                    if (!string.IsNullOrEmpty(GroupUsersRemovedfirstUser))
                    {
                    return $"Group **{GroupUsersRemovedGroupName}** (ID: {GroupUsersRemovedGroupId}) had {GroupUsersRemovedCount} users Removed. First user: **{GroupUsersRemovedfirstUser}**";
                    // FIXED: Changed 'groupId' to 'GroupUsersgroupId' ^^^
                    }
                    else
                    {
                    return $"Group **{GroupUsersRemovedGroupName}** (ID: {GroupUsersRemovedGroupId}) had {GroupUsersRemovedCount} users Removed, but no user details were retrieved.";
                    }
                }

            // ==================== hypeRate.IO ========================

            case EventType.HypeRateConnected:
                CPH.TryGetArg("triggerName", out string HypeRateConnectedTriggerName);                                                              /* The name of the trigger which executed the action */
                CPH.TryGetArg("eventSource", out string HypeRateConnectedEventSource);                                                              /* The service of the event which triggered the action.*/
                return $"have been <strong>{HypeRateConnectedTriggerName}</strong>";

            case EventType.HypeRateDisconnected:
                CPH.TryGetArg("triggerName", out string HypeRateDisconnectedTriggerName);                                                           /* The name of the trigger which executed the action */
                CPH.TryGetArg("eventSource", out string HypeRateDisconnectedEventSource);                                                           /* The service of the event which triggered the action.*/
                return $"have been <strong>{HypeRateDisconnectedTriggerName}</strong>";

            case EventType.HypeRateHeartRatePulse:
                CPH.TryGetArg("heartRate", out int HypeRateHeartRatePulseheartRate);
                return $"<strong>No description provided</strong>";

            case EventType.HypeRateTwitchClipCreated:
                CPH.TryGetArg("slug", out string HypeRateTwitchClipCreatedslug);
                CPH.TryGetArg("url", out string HypeRateTwitchClipCreatedurl);
                return $"<strong>No description provided</strong>";

            // ==================== Input ========================

            case EventType.InputKeyPress:
                CPH.TryGetArg("keyCode", out int InputKeyPresskeyCode);
                CPH.TryGetArg("modifierMask", out int InputKeyPressmodifierMask);
                CPH.TryGetArg("hasCtrl", out bool InputKeyPresshasCtrl);
                CPH.TryGetArg("hasAlt", out bool InputKeyPresshasAlt);
                CPH.TryGetArg("hasShift", out bool InputKeyPresshasShift);
                CPH.TryGetArg("hasWin", out bool InputKeyPresshasWin);
                return $"<strong>No description provided</strong>";

            case EventType.InputMouseClick:
                CPH.TryGetArg("button", out int InputMouseClickbutton);
                CPH.TryGetArg("clicks", out int InputMouseClickclicks);
                CPH.TryGetArg("x", out int InputMouseClickx);
                CPH.TryGetArg("y", out int InputMouseClicky);
                return $"<strong>No description provided</strong>";

            // ==================== Kick ========================
            case EventType.KickBroadcasterAuthenticated:
                CPH.TryGetArg("isTest", out int KickBroadcasterAuthenticatedIsTest);
                return $"<strong>No description provided</strong>";

            case EventType.KickBroadcasterChatConnected:
                CPH.TryGetArg("isTest", out int KickBroadcasterChatConnectedIsTest);
                return $"<strong>No description provided</strong>";

            case EventType.KickBroadcasterChatDisconnected:
                CPH.TryGetArg("isTest", out int KickBroadcasterChatDisconnectedIsTest);
                return $"<strong>No description provided</strong>";

            case EventType.KickChannelUpdate:
                CPH.TryGetArg("channelId", out string KickChannelUpdatechannelId);
                CPH.TryGetArg("channel", out string KickChannelUpdatechannel);
                CPH.TryGetArg("title", out string KickChannelUpdatetitle);
                CPH.TryGetArg("categoryId", out int KickChannelUpdatecategoryId);
                CPH.TryGetArg("statusUpdate", out bool statusUpdate);
                CPH.TryGetArg("categoryName", out string KickChannelUpdatecategoryName);
                CPH.TryGetArg("categoryThumbnail", out string KickChannelUpdatecategoryThumbnail);
                CPH.TryGetArg("oldTitle", out string KickChannelUpdateoldTitle);
                CPH.TryGetArg("oldCategoryId", out int KickChannelUpdateoldCategoryId);
                CPH.TryGetArg("oldCategoryName", out string KickChannelUpdateoldCategoryName);
                CPH.TryGetArg("oldCategoryThumbnail", out string KickChannelUpdateoldCategoryThumbnail);
                CPH.TryGetArg("categoryUpdate", out bool categoryUpdate);
                CPH.TryGetArg("is_test", out bool KickChannelUpdateistest);
                CPH.TryGetArg("status", out string status);
                return $"<strong>No description provided</strong>";

            case EventType.KickChatMessage:
                CPH.TryGetArg("isAnonymous", out bool KickChatMessageisAnonymous);
                CPH.TryGetArg("user", out object KickChatMessagekickChatUser);
                CPH.TryGetArg("messageId", out string KickChatMessagemessageId);
                CPH.TryGetArg("parts", out string KickChatMessageparts);
                CPH.TryGetArg("text", out string KickChatMessagetext);
                CPH.TryGetArg("isReply", out bool KickChatMessageisReply);
                CPH.TryGetArg("reply", out object KickChatMessagereply);
                CPH.TryGetArg("isInternal", out bool KickChatMessageisInternal);
                CPH.TryGetArg("isTest", out bool KickChatMessageisTest);
                return $"💬 <strong>{KickChatMessagekickChatUser}</strong>: {HtmlEncode(KickChatMessagemessageId)}";

            case EventType.KickFirstWords:
                CPH.TryGetArg("isAnonymous", out bool KickFirstWordsisAnonymous);
                CPH.TryGetArg("user", out object KickFirstWordsUser);
                CPH.TryGetArg("messageId", out string KickFirstWordsmessageId);
                CPH.TryGetArg("parts", out string KickFirstWordsparts);
                CPH.TryGetArg("text", out string KickFirstWordstext);
                CPH.TryGetArg("isReply", out bool KickFirstWordsReply);
                CPH.TryGetArg("reply", out object KickFirstWordsreply);
                CPH.TryGetArg("isInternal", out bool KickFirstWordsisInternal);
                CPH.TryGetArg("isTest", out bool KickFirstWordsisTest);
                return $"🎉 <strong>{KickFirstWordsUser}</strong> said their first words: {HtmlEncode(KickFirstWordstext)}";

            case EventType.KickFollow:
                CPH.TryGetArg("user", out string kickFollowUser);
                return $"<strong>{kickFollowUser}</strong> followed the channel";

            case EventType.KickGiftSubscription:
                {
                    CPH.TryGetArg("user", out string user);
                    CPH.TryGetArg("recipient.userName", out string recipientUser);
                    return $"<strong>No description provided</strong>";
                }

            case EventType.KickMassGiftSubscription:
                return $"<strong>No description provided</strong>";

            case EventType.KickPresentViewers:
                CPH.TryGetArg("triggerName", out string KickPresentViewers);                                                                        /* The name of the trigger which executed the action */
                return $"<strong>📊 Present viewers check</strong>";

            case EventType.KickResubscription:
                CPH.TryGetArg("user", out string KickResubscriptionUser);
                CPH.TryGetArg("monthsSubscribed", out int KickResubscriptionMonthsSubscribed);
                return $"<strong>Present viewer list updated</strong>";

            case EventType.KickSevenTVEmoteAdded:
                return $"<strong>No description provided</strong>";

            case EventType.KickSevenTVEmoteRemoved:
                return $"<strong>No description provided</strong>";

            case EventType.KickStreamOffline:
                return $"<strong>No description provided</strong>";

            case EventType.KickStreamOnline:
                return $"<strong>No description provided</strong>";

            case EventType.KickSubscription:
                return $"<strong>No description provided</strong>";

            case EventType.KickUserBanned:
                CPH.TryGetArg("KickUserBanneduser", out string KickUserBannedUser);
                CPH.TryGetArg("createdByDisplayName", out string KickUserBannedCreatedByDisplayName);
                return $"<strong>No description provided</strong>";

            case EventType.KickUserTimedOut:
                CPH.TryGetArg("user", out string KickUserTimedOutUser);
                CPH.TryGetArg("createdByDisplayName", out string KickUserTimedOutCreatedByDisplayName);
                CPH.TryGetArg("reason", out string KickUserTimedOutReason);
                return $"<strong>No description provided</strong>";

            case EventType.KickViewerCountUpdate:
                return $"<strong>No description provided</strong>";


            // ==================== Ko-FI ========================
            case EventType.KofiCommission:
{
                    // Check for both "from_name" and "from" variables
                    CPH.TryGetArg("from_name", out string KofiCommissionFromName); // First, try "from_name"
                    if (string.IsNullOrEmpty(KofiCommissionFromName))
                    {
                        // If "from_name" is empty, try "from" as a fallback
                        CPH.TryGetArg("from", out KofiCommissionFromName);
                    }

                    CPH.TryGetArg("amount", out double KofiCommissionAmount);
                    CPH.TryGetArg("currency", out string KofiCommissionCurrency);
                    CPH.TryGetArg("message", out string KofiCommissionMessage);

                    // Debug: Log donation details
                    CPH.LogDebug($"From Name: {KofiCommissionFromName}");
                    CPH.LogDebug($"Amount: {KofiCommissionAmount}");
                    CPH.LogDebug($"Currency: {KofiCommissionCurrency}");
                    CPH.LogDebug($"Message: { KofiCommissionMessage}");
                }
                return $"<strong>No description provided</strong>";

            case EventType.KofiDonation:
                {
                    // Check for both "from_name" and "from" variables
                    CPH.TryGetArg("from_name", out string KofiDonationfromname); // First, try "from_name"
                    if (string.IsNullOrEmpty(KofiDonationfromname))
                    {
                        // If "from_name" is empty, try "from" as a fallback
                        CPH.TryGetArg("from", out KofiDonationfromname);
                    }

                    CPH.TryGetArg("amount", out double KofiDonationamount);
                    CPH.TryGetArg("currency", out string KofiDonationcurrency);
                    CPH.TryGetArg("message", out string KofiDonationmessage);

                    // Debug: Log donation details
                    CPH.LogDebug($"From Name: {KofiDonationfromname}");
                    CPH.LogDebug($"Amount: {KofiDonationamount}");
                    CPH.LogDebug($"Currency: {KofiDonationcurrency}");
                    CPH.LogDebug($"Message: {KofiDonationmessage}");
                }
                return $"<strong>No description provided</strong>";

            case EventType.KofiResubscription:
                {
                    // Check for both "from_name" and "from" variables
                    CPH.TryGetArg("from_name", out string KofiResubscriptionFromname); // First, try "from_name"
                    if (string.IsNullOrEmpty(KofiResubscriptionFromname))
                    {
                        // If "from_name" is empty, try "from" as a fallback
                        CPH.TryGetArg("from", out KofiResubscriptionFromname);
                    }
                    CPH.TryGetArg("message", out string KofiResubscriptionMessage);
                    CPH.TryGetArg("tier", out string KofiResubscriptionTier);

                    // Debug: Log donation details
                    CPH.LogDebug($"From Name: {KofiResubscriptionFromname}");
                    CPH.LogDebug($"Message: {KofiResubscriptionMessage}");
                    CPH.LogDebug($"tier: {KofiResubscriptionTier}");
                }
                return $"<strong>No description provided</strong>";

            case EventType.KofiShopOrder:
                {
                    // Check for both "from_name" and "from" variables
                    CPH.TryGetArg("from_name", out string KofiShopOrderFromname); // First, try "from_name"
                    if (string.IsNullOrEmpty(KofiShopOrderFromname))
                    {
                        // If "from_name" is empty, try "from" as a fallback
                        CPH.TryGetArg("from", out KofiShopOrderFromname);
                    }

                    CPH.TryGetArg("item0", out string KofiShopOrderitem0); // item0 is the name of the item ordered
                    CPH.TryGetArg("amount", out double KofiShopOrderamount);
                    CPH.TryGetArg("currency", out string KofiShopOrderCurrency);

                    // Debug: Log the value of "from_name" (or "from") and other arguments
                    Console.WriteLine($"From Name: {KofiShopOrderFromname}");
                    Console.WriteLine($"Item Ordered: {KofiShopOrderitem0}");
                    Console.WriteLine($"Amount: {KofiShopOrderamount}");
                    Console.WriteLine($"Currency: {KofiShopOrderCurrency}");
                }
                return $"<strong>No description provided</strong>";

            case EventType.KofiSubscription:
                {
                    // Check for both "from_name" and "from" variables
                    CPH.TryGetArg("from_name", out string KofiSubscriptionFromname); // First, try "from_name"
                    if (string.IsNullOrEmpty(KofiSubscriptionFromname))
                    {
                        // If "from_name" is empty, try "from" as a fallback
                        CPH.TryGetArg("from", out KofiSubscriptionFromname);
                    }
                    CPH.TryGetArg("message", out string KofiSubscriptionMessage);
                    CPH.TryGetArg("tier", out string KofiSubscriptionTier);

                    // Debug: Log donation details
                    CPH.LogDebug($"From Name: {KofiSubscriptionFromname}");
                    CPH.LogDebug($"Message: {KofiSubscriptionMessage}");
                    CPH.LogDebug($"tier: {KofiSubscriptionTier}");
                }
                return $"<strong>No description provided</strong>";

            // ==================== Meld Studio ========================
            case EventType.MeldStudioConnected:
                return $"<strong>No description provided</strong>";

            case EventType.MeldStudioDisconnected:
                return $"<strong>No description provided</strong>";

            case EventType.MeldStudioEvent:
                return $"<strong>No description provided</strong>";

            case EventType.MeldStudioLayerVisbilityChanged:
                return $"<strong>No description provided</strong>";

            case EventType.MeldStudioLEffectEnabledStateChanged:
                return $"<strong>No description provided</strong>";

            case EventType.MeldStudioRecordingStarted:
                return $"<strong>No description provided</strong>";

            case EventType.MeldStudioRecordingStopped:
                return $"<strong>No description provided</strong>";

            case EventType.MeldStudioSceneChanged:
                return $"<strong>No description provided</strong>";

            case EventType.MeldStudioStreamingStarted:
                return $"<strong>No description provided</strong>";

            case EventType.MeldStudioStreamingStopped:
                return $"<strong>No description provided</strong>";

            case EventType.MeldStudioTrackMonitoringStateChanged:
                return $"<strong>No description provided</strong>";

            case EventType.MeldStudioTrackMustedStateChanged:
                return $"<strong>No description provided</strong>";

            // ==================== MIDI ========================
            case EventType.Custom:
                CPH.TryGetArg("data", out string CustomData);
                return $"<strong>No description provided</strong>";

            // ==================== Misc ========================
            case EventType.Test:
                CPH.TryGetArg("isTest", out bool isTest);                                                                                           /* if test tigger is False our true */
                CPH.TryGetArg("triggerCategory", out string TestTriggerCategory);                                                                   /* The category of the trigger which executed the action */
                CPH.TryGetArg("runningActionId", out Guid TestRunningActionId);                                                                     /* The unique ID of this running action instance within the queue */
                CPH.TryGetArg("actionQueuedAt", out DateTime TestActionQueuedAt);                                                                   /* The timestamp of when action was queued */
                CPH.TryGetArg("triggerId", out Guid TestTriggerId);                                                                                 /* The unique id of the trigger with executed the action */
                CPH.TryGetArg("triggerName", out string TestTriggerName);                                                                           /* The name of the trigger which executed the action */
                CPH.TryGetArg("actionId", out Guid TestActionId);                                                                                   /* The unique ID of the action being executed */
                CPH.TryGetArg("actionName", out string TestActionName);                                                                             /* The name of the action being executed */
                CPH.TryGetArg("eventSource", out string TestEventSource);                                                                           /* The service of the event which triggered the action.*/
                return $"{TestTriggerName} trigger event in actions group<strong> • {TestActionName} • </strong>";

            // ==================== OBS ========================
            case EventType.ObsConnected:
                CPH.TryGetArg("triggerCategory", out string ObsConnectedTriggerCategory);                                                           /* The category of the trigger which executed the action */
                CPH.TryGetArg("isTest", out bool ObsConnectedIsTest);                                                                               /* if test tigger is False our true */
                CPH.TryGetArg("runningActionId", out Guid ObsConnectedRunningActionId);                                                             /* The unique ID of this running action instance within the queue */
                CPH.TryGetArg("actionQueuedAt", out DateTime ObsConnectedActionQueuedAt);                                                           /* The timestamp of when action was queued */
                CPH.TryGetArg("triggerId", out Guid ObsConnectedTriggerId);                                                                         /* The unique id of the trigger with executed the action */
                CPH.TryGetArg("triggerName", out string ObsConnectedTriggerName);                                                                   /* The name of the trigger which executed the action */
                CPH.TryGetArg("actionId", out Guid ObsConnectedActionId);                                                                           /* The unique ID of the action being executed */
                CPH.TryGetArg("actionName", out string ObsConnectedActionName);                                                                     /* The name of the action being executed */
                CPH.TryGetArg("eventSource", out string ObsConnectedEventSource);                                                                   /* The service of the event which triggered the action.*/
                return $"{ObsConnectedTriggerCategory}<strong> have been </strong> {ObsConnectedTriggerName}";

            case EventType.ObsDisconnected:
                CPH.TryGetArg("triggerCategory", out string ObsDisconnectedTriggerCategory);                                                        /* The category of the trigger which executed the action */
                CPH.TryGetArg("isTest", out bool ObsDisconnectedIsTest);                                                                            /* if test tigger is False our true */
                CPH.TryGetArg("runningActionId", out Guid ObsDisconnectedRunningActionId);                                                          /* The unique ID of this running action instance within the queue */
                CPH.TryGetArg("actionQueuedAt", out DateTime ObsDisconnectedActionQueuedAt);                                                        /* The timestamp of when action was queued */
                CPH.TryGetArg("triggerId", out Guid ObsDisconnectedTriggerId);                                                                      /* The unique id of the trigger with executed the action */
                CPH.TryGetArg("triggerName", out string ObsDisconnectedTriggerName);                                                                /* The name of the trigger which executed the action */
                CPH.TryGetArg("actionId", out Guid ObsDisconnectedActionId);                                                                        /* The unique ID of the action being executed */
                CPH.TryGetArg("actionName", out string ObsDisconnectedActionName);                                                                  /* The name of the action being executed */
                CPH.TryGetArg("eventSource", out string ObsDisconnectedEventSource);                                                                /* The service of the event which triggered the action.*/
                return $"{ObsDisconnectedTriggerCategory}<strong> have been </strong> {ObsDisconnectedTriggerName}";
                

            case EventType.ObsEvent:
                CPH.TryGetArg("triggerCategory", out string ObsEventTriggerCategory);                                                               /* The category of the trigger which executed the action */
                CPH.TryGetArg("isTest", out bool ObsEventIsTest);                                                                                   /* if test tigger is False our true */
                CPH.TryGetArg("runningActionId", out Guid ObsEventRunningActionId);                                                                 /* The unique ID of this running action instance within the queue */
                CPH.TryGetArg("actionQueuedAt", out DateTime ObsEventActionQueuedAt);                                                               /* The timestamp of when action was queued */
                CPH.TryGetArg("triggerId", out Guid ObsEventTriggerId);                                                                             /* The unique id of the trigger with executed the action */
                CPH.TryGetArg("triggerName", out string ObsEventTriggerName);                                                                       /* The name of the trigger which executed the action */
                CPH.TryGetArg("actionId", out Guid ObsEventActionId);                                                                               /* The unique ID of the action being executed */
                CPH.TryGetArg("actionName", out string ObsEventActionName);                                                                         /* The name of the action being executed */
                CPH.TryGetArg("eventSource", out string ObsEventEventSource);                                                                       /* The service of the event which triggered the action.*/
                CPH.TryGetArg("obsEvent.event", out string ObsEventEvent);                                                                          /* obs */
                return $"<strong>No description provided</strong>";

            case EventType.ObsRecordingStarted:
                CPH.TryGetArg("triggerCategory", out string ObsRecordingStartedTriggerCategory);                                                    /* The category of the trigger which executed the action */
                CPH.TryGetArg("triggerName", out string ObsRecordingStartedTriggerName);                                                            /* The name of the trigger which executed the action */
                CPH.TryGetArg("obs.id",out Guid ObsRecordingStartedObsID);                                                                          /* Recording Started */
                CPH.TryGetArg("eventSource", out string ObsRecordingStartedEventSource);                                                            /* The service of the event which triggered the action.*/
                return $"<strong>No description provided</strong>";

            case EventType.ObsRecordingStopped:
                CPH.TryGetArg("triggerCategory", out string ObsRecordingStoppedTriggerCategory);                                                    /* The category of the trigger which executed the action */
                CPH.TryGetArg("triggerName", out string ObsRecordingStoppedTriggerName);                                                            /* The name of the trigger which executed the action */
                CPH.TryGetArg("obs.id",out Guid ObsRecordingStoppedObsID);                                                                          /* Recording Started */
                CPH.TryGetArg("eventSource", out string ObsRecordingStoppedEventSource);                                                            /* The service of the event which triggered the action.*/
                return $"<strong>No description provided</strong>";

            case EventType.ObsSceneChanged:
                CPH.TryGetArg("triggerCategory", out string ObsSceneChangedTriggerCategory);                                                        /* The category of the trigger which executed the action */
                CPH.TryGetArg("triggerName", out string ObsSceneChangedTriggerName);                                                                /* The name of the trigger which executed the action */
                CPH.TryGetArg("obs.id",out Guid ObsSceneChangedObsID); /*Recording Started*/
                CPH.TryGetArg("eventSource", out string ObsSceneChangedEventSource);                                                                /* The service of the event which triggered the action.*/
                CPH.TryGetArg("SomeScene", out string ObsSceneChangedSomeScene); /*obs*/
                return $"{ObsSceneChangedTriggerCategory}<strong> Scene change to </strong>{ObsSceneChangedSomeScene}";

            case EventType.ObsStreamingStarted:
                CPH.TryGetArg("triggerCategory", out string ObsStreamingStartedTriggerCategory);                                                    /* The category of the trigger which executed the action */
                CPH.TryGetArg("isTest", out bool ObsStreamingStartedisTest); /* example True/False */
                CPH.TryGetArg("runningActionId", out Guid ObsStreamingStartedRunningActionId);                                                      /* The unique ID of this running action instance within the queue */
                CPH.TryGetArg("actionQueuedAt", out DateTime ObsStreamingStartedActionQueuedAt);                                                    /* The timestamp of when action was queued */
                CPH.TryGetArg("triggerId", out Guid ObsStreamingStartedTriggerId);                                                                  /* The unique id of the trigger with executed the action */
                CPH.TryGetArg("triggerName", out string ObsStreamingStartedTriggerName);                                                            /* The name of the trigger which executed the action */
                CPH.TryGetArg("actionId", out Guid ObsStreamingStartedActionId);                                                                    /* The unique ID of the action being executed */
                CPH.TryGetArg("actionName", out string ObsStreamingStartedActionName);                                                              /* The name of the action being executed */ 
                CPH.TryGetArg("eventSource", out string ObsStreamingStartedEventSource);                                                            /* The service of the event which triggered the action.*/
                return $"{ObsStreamingStartedTriggerCategory}<strong> {ObsStreamingStartedTriggerName}</strong>";

            case EventType.ObsStreamingStopped:
                CPH.TryGetArg("triggerCategory", out string ObsStreamingStoppedTriggerCategory);                                                    /* The category of the trigger which executed the action */
                CPH.TryGetArg("isTest", out bool ObsStreamingStoppedisTest); /* example True/False */
                CPH.TryGetArg("runningActionId", out Guid ObsStreamingStoppedRunningActionId);                                                      /* The unique ID of this running action instance within the queue */
                CPH.TryGetArg("actionQueuedAt", out DateTime ObsStreamingStoppedActionQueuedAt);                                                    /* The timestamp of when action was queued */
                CPH.TryGetArg("triggerId", out Guid ObsStreamingStoppedTriggerId);                                                                  /* The unique id of the trigger with executed the action */
                CPH.TryGetArg("triggerName", out string ObsStreamingStoppedTriggerName);                                                            /* The name of the trigger which executed the action */
                CPH.TryGetArg("actionId", out Guid ObsStreamingStoppedActionId);                                                                    /* The unique ID of the action being executed */
                CPH.TryGetArg("actionName", out string ObsStreamingStoppedActionName);                                                              /* The name of the action being executed */  
                CPH.TryGetArg("eventSource", out string ObsStreamingStoppedEventSource);                                                            /* The service of the event which triggered the action.*/
                return $"{ObsStreamingStoppedTriggerCategory}<strong> {ObsStreamingStoppedTriggerName}</strong>";

            case EventType.ObsVendorEvent:
                CPH.TryGetArg("triggerCategory", out string ObsVendorEventTriggerCategory);                                                         /* The category of the trigger which executed the action */
                CPH.TryGetArg("isTest", out bool ObsVendorEventisTest); /* example True/False */
                CPH.TryGetArg("runningActionId", out Guid ObsVendorEventRunningActionId);                                                           /* The unique ID of this running action instance within the queue */
                CPH.TryGetArg("actionQueuedAt", out DateTime ObsVendorEventActionQueuedAt);                                                         /* The timestamp of when action was queued */
                CPH.TryGetArg("triggerId", out Guid ObsVendorEventTriggerId);                                                                       /* The unique id of the trigger with executed the action */
                CPH.TryGetArg("triggerName", out string ObsVendorEventTriggerName);                                                                 /* The name of the trigger which executed the action */
                CPH.TryGetArg("actionId", out Guid ObsVendorEventActionId);                                                                         /* The unique ID of the action being executed */
                CPH.TryGetArg("actionName", out string ObsVendorEventActionName);                                                                   /* The name of the action being executed */  
                CPH.TryGetArg("eventSource", out string ObsVendorEventEventSource);                                                                 /* The service of the event which triggered the action.*/
                CPH.TryGetArg("obsVendorEvent.vendor", out string ObsVendorEventVendor); /**/
                CPH.TryGetArg("obsVendorEvent.event", out string ObsVendorEventEvent); /**/
                return $"<strong>No description provided</strong>";

            // ==================== Pally.gg ========================
            case EventType.PallyggCampaignTip:
                CPH.TryGetArg("triggerCategory", out string PallyggCampaignTipTriggerCategory);                                                     /* The category of the trigger which executed the action */
                CPH.TryGetArg("isTest", out bool PallyggCampaignTipisTest);                                             /* example True/False */
                CPH.TryGetArg("runningActionId", out Guid PallyggCampaignTipRunningActionId);                                                       /* The unique ID of this running action instance within the queue */
                CPH.TryGetArg("actionQueuedAt", out DateTime PallyggCampaignTipActionQueuedAt);                                                     /* The timestamp of when action was queued */
                CPH.TryGetArg("triggerId", out Guid PallyggCampaignTipTriggerId);                                                                   /* The unique id of the trigger with executed the action */
                CPH.TryGetArg("triggerName", out string PallyggCampaignTipTriggerName);                                                             /* The name of the trigger which executed the action */
                CPH.TryGetArg("actionId", out Guid PallyggCampaignTipActionId);                                                                     /* The unique ID of the action being executed */
                CPH.TryGetArg("actionName", out string PallyggCampaignTipActionName);                                                               /* The name of the action being executed */ 
                CPH.TryGetArg("eventSource", out string PallyggCampaignTipEventSource);                                                             /* The service of the event which triggered the action.*/
                CPH.TryGetArg("campaignId", out string PallyggCampaignTipCampaignId);                                   /*0x9b195b4f,0x89f6,0x419e,{0xb3,0x1a,0xd7,0x81,0x8c,0x8e,0x8b,0xf7*/
                CPH.TryGetArg("campaign", out string PallyggCampaignTipcampaign);                                       /*pally*/
                CPH.TryGetArg("campaignTitle", out string PallyggCampaignTipCampaignTitle);                             /*"Test Campaign"*/
                CPH.TryGetArg("campaignUrl", out string PallyggCampaignTipCampaignUrl);                                 /*https://pally.gg/p/pally"*/
                CPH.TryGetArg("tipDisplayName", out string PallyggCampaignTipDisplayName);                              /*TestUser*/
                CPH.TryGetArg("tipGrossAmount", out Decimal PallyggCampaignTipTipGrossAmount);                          /*60,271453124597395*/
                CPH.TryGetArg("tipGrossAmountFormatted", out string PallyggCampaignTipGrossAmountFormatted);            /*€60,27*/
                CPH.TryGetArg("tipGrossAmountInCents", out Decimal PallyggCampaignTipGrossAmountInCent);                /*6027,145312459739500*/
                CPH.TryGetArg("tipId", out string PallyggCampaignTipID);                                                /*0x557f1749,0x3418,0x4085,{0xae,0xcd,0x0c,0xf3,0x22,0xd3,0x07,0x2c*/
                CPH.TryGetArg("tipMessage", out string PallyggCampaignTipMessage);                                      /*This is a test campaign tip*/
                CPH.TryGetArg("tipNetAmount", out Decimal PallyggCampaignTipNetAmount);                                 /*59,851453124597395*/
                CPH.TryGetArg("tipNetAmountFormatted", out string PallyggCampaignTipNetAmountFormatted);                /*€ 59,85*/
                CPH.TryGetArg("tipNetAmountInCents", out Decimal PallyggCampaignTipNetAmountInCent);                    /*5985,145312459739500*/
                CPH.TryGetArg("tipProccessingFee", out Decimal PallyggCampaignTipProccessingFee);                       /* 0,42*/
                CPH.TryGetArg("tipProccessingFeeFormatted", out string PallyggCampaignTipProccessingFeeFormatted);      /*€ 0,42*/
                CPH.TryGetArg("tipProccessingFeeInCents", out int PallyggCampaignTipProccessingFeeInCents);               /*42*/
                // ✅ Conditional message display
                string PallyggCampaignTipfinalMsgDisplay = "";
                if (!string.IsNullOrWhiteSpace(PallyggCampaignTipMessage))
                {
                    PallyggCampaignTipfinalMsgDisplay = $" • Message: \"{HtmlEncode(PallyggCampaignTipMessage)}\"";
                }
                return $"{PallyggCampaignTipDisplayName} <strong>contributed</strong> {PallyggCampaignTipNetAmountFormatted}{PallyggCampaignTipfinalMsgDisplay}";
            


            case EventType.PallyggConnected:
                CPH.TryGetArg("triggerCategory", out string PallyggConnectedTriggerCategory);                                                       /* The category of the trigger which executed the action */
                CPH.TryGetArg("isTest", out bool PallyggConnectedisTest);                                             /* example True/False */
                CPH.TryGetArg("runningActionId", out Guid PallyggConnectedRunningActionId);                                                         /* The unique ID of this running action instance within the queue */
                CPH.TryGetArg("actionQueuedAt", out DateTime PallyggConnectedActionQueuedAt);                                                       /* The timestamp of when action was queued */
                CPH.TryGetArg("triggerId", out Guid PallyggConnectedTriggerId);                                                                     /* The unique id of the trigger with executed the action */
                CPH.TryGetArg("triggerName", out string PallyggConnectedTriggerName);                                                               /* The name of the trigger which executed the action */
                CPH.TryGetArg("actionId", out Guid PallyggConnectedActionId);                                                                       /* The unique ID of the action being executed */
                CPH.TryGetArg("actionName", out string PallyggConnectedActionName);                                                                 /* The name of the action being executed */ 
                CPH.TryGetArg("eventSource", out string PallyggConnectedEventSource);                                                               /* The service of the event which triggered the action.*/
                return $"{PallyggConnectedEventSource}<strong> {PallyggConnectedTriggerName}</strong>";

            case EventType.PallyggDisconnected:
                CPH.TryGetArg("triggerCategory", out string PallyggDisconnectedTriggerCategory);                                                    /* The category of the trigger which executed the action */
                CPH.TryGetArg("isTest", out bool PallyggDisconnectedisTest);                                                                        /* example True/False */
                CPH.TryGetArg("runningActionId", out Guid PallyggDisconnectedRunningActionId);                                                      /* The unique ID of this running action instance within the queue */
                CPH.TryGetArg("actionQueuedAt", out DateTime PallyggDisconnectedActionQueuedAt);                                                    /* The timestamp of when action was queued */
                CPH.TryGetArg("triggerId", out Guid PallyggDisconnectedTriggerId);                                                                  /* The unique id of the trigger with executed the action */
                CPH.TryGetArg("triggerName", out string PallyggDisconnectedTriggerName);                                                            /* The name of the trigger which executed the action */
                CPH.TryGetArg("actionId", out Guid PallyggDisconnectedActionId);                                                                    /* The unique ID of the action being executed */
                CPH.TryGetArg("actionName", out string PallyggDisconnectedActionName);                                                              /* The name of the action being executed */ 
                CPH.TryGetArg("eventSource", out string PallyggDisconnectedEventSource);                                                            /* The service of the event which triggered the action.*/
                return $"{PallyggDisconnectedEventSource}<strong> {PallyggDisconnectedTriggerName}</strong>";

            // ==================== Patreon ========================

            case EventType.PatreonFollowCreated:
                CPH.TryGetArg("triggerCategory", out string PatreonFollowCreatedTriggerCategory);                                                   /* The category of the trigger which executed the action */
                CPH.TryGetArg("isTest", out bool PatreonFollowCreatedisTest);                                                                       /* example True/False */
                CPH.TryGetArg("runningActionId", out Guid PatreonFollowCreatedRunningActionId);                                                     /* The unique ID of this running action instance within the queue */
                CPH.TryGetArg("actionQueuedAt", out DateTime PatreonFollowCreatedActionQueuedAt);                                                   /* The timestamp of when action was queued */
                CPH.TryGetArg("triggerId", out Guid PatreonFollowCreatedTriggerId);                                                                 /* The unique id of the trigger with executed the action */
                CPH.TryGetArg("triggerName", out string PatreonFollowCreatedTriggerName);                                                           /* The name of the trigger which executed the action */
                CPH.TryGetArg("actionId", out Guid PatreonFollowCreatedActionId);                                                                   /* The unique ID of the action being executed */
                CPH.TryGetArg("actionName", out string PatreonFollowCreatedActionName);                                                             /* The name of the action being executed */ 
                CPH.TryGetArg("eventSource", out string PatreonFollowCreatedEventSource);                                                           /* The service of the event which triggered the action.*/
                CPH.TryGetArg("id", out string PatreonFollowCreatedId);                                                                             /* b587ac37-ac33-41dd-99df-edf8a307f6d6 */
                CPH.TryGetArg("attributes.campaign_lifetime_support_cents", out int PatreonFollowCreatedAttributesCampaignLifetimeSupportCents);    /* 0 */
                CPH.TryGetArg("attributes.currently_entitled_amount_cents", out int PatreonFollowCreatedAttributesCurrentlyEntitledAmountCents);    /* 0 */
                CPH.TryGetArg("attributes.email", out string PatreonFollowCreatedAttributesEmail);                                                  /* someone@somewhere.com*/
                CPH.TryGetArg("attributes.full_name", out string PatreonFollowCreatedAttributesFullName);                                           /* Someone*/
                CPH.TryGetArg("attributes.is_follower", out bool PatreonFollowCreatedAttributesIsFollower);                                         /* example True/False */
                CPH.TryGetArg("attributes.last_charge_date", out string PatreonFollowCreatedAttributesLastChargeDate);                              /* 01 /01/0001 00:00:00 */
                CPH.TryGetArg("attributes.last_charge_status", out string PatreonFollowCreatedAttributesLastChargeStatus);                          /* "" */
                CPH.TryGetArg("attributes.lifetime_support_cents", out int PatreonFollowCreatedAttributesLifetimeSupportCents);                     /* 0 */
                CPH.TryGetArg("attributes.next_charge_date", out string PatreonFollowCreatedAttributesNextChargeDate);                              /* 01 /01/0001 00:00:00 */
                CPH.TryGetArg("attributes.note", out string PatreonFollowCreatedAttributesNote);                                                    /* "" */
                CPH.TryGetArg("attributes.patron_status", out string PatreonFollowCreatedAttributesPatronStatus);                                   /* "" **/
                CPH.TryGetArg("attributes.pledge_cadence", out int PatreonFollowCreatedAttributesPledgeCadence);                                    /* 1 */
                CPH.TryGetArg("attributes.pledge_relationship_start", out string PatreonFollowCreatedAttributesPledgeRelationshipStart);            /* 01 /01/0001 00:00:00 */
                CPH.TryGetArg("attributes.will_pay_amount_cents", out int PatreonFollowCreatedAttributesWillPayAmountCents);                        /* 0 */
                CPH.TryGetArg("user.id", out string PatreonFollowCreatedUserId);                                                                    /* 12345678 */
                CPH.TryGetArg("user.type", out string PatreonFollowCreatedUserType);                                                                /* user */
                CPH.TryGetArg("user.attributes.created", out DateTime PatreonFollowCreatedUserAttributesCreated);                                   /* 0001 - 01 - 01 01:00:00 */
                CPH.TryGetArg("user.attributes.first_name", out string PatreonFollowCreatedUserAttributesFirstName);                                /* Someone */
                CPH.TryGetArg("user.attributes.full_name", out string PatreonFollowCreatedUserAttributesFullName);                                  /* Someone */
                CPH.TryGetArg("user.attributes.hide_pledges", out bool PatreonFollowCreatedUserAttributesHidePledges);                              /* example True/False */
                CPH.TryGetArg("user.attributes.image_url", out string PatreonFollowCreatedUserAttributesImageUrl);                                  /* "" */
                CPH.TryGetArg("user.attributes.is_creator", out bool PatreonFollowCreatedUserAttributesIsCreator);                                  /* example True/False */
                CPH.TryGetArg("user.attributes.last_name", out string PatreonFollowCreatedUserAttributesLastName);                                  /* "" */
                CPH.TryGetArg("user.attributes.like_count", out int PatreonFollowCreatedUserAttributesLikeCount);                                   /* 0 */
                CPH.TryGetArg("user.attributes.thumb_url", out string PatreonFollowCreatedUserAttributesThumbUrl);                                  /* "" */
                CPH.TryGetArg("user.attributes.url", out string PatreonFollowCreatedUserAttributesUrl);                                             /* "" */
                return $"<strong>No description provided</strong>";

            case EventType.PatreonFollowDeleted:
                return $"<strong>No description provided</strong>";

            case EventType.PatreonPledgeCreated:
                return $"<strong>No description provided</strong>";

            case EventType.PatreonPledgeDeleted:
                return $"<strong>No description provided</strong>";

            case EventType.PatreonPledgeUpdated:
                return $"<strong>No description provided</strong>";

            // ==================== Process ========================
            case EventType.ProcessStarted:
                return $"<strong>No description provided</strong>";

            case EventType.ProcessStopped:
                return $"<strong>No description provided</strong>";

            // ==================== Pulsoid ========================
            case EventType.PulsoidHeartRatePulse:
                return $"<strong>No description provided</strong>";

            // ==================== Quote ========================
            case EventType.QuoteAdded:
                return $"<strong>No description provided</strong>";
            case EventType.QuoteShow:
                return $"<strong>No description provided</strong>";
            // ==================== Raw ========================
            case EventType.RawAction:
                return $"<strong>No description provided</strong>";
            case EventType.RawActionCompleted:
                return $"<strong>No description provided</strong>";
            case EventType.RawSubAction:
                return $"<strong>No description provided</strong>";

            // ==================== Shopify ========================
            case EventType.ShopifyOrderCreated:
                return $"<strong>No description provided</strong>";
            case EventType.ShopifyOrderPaid:
                return $"<strong>No description provided</strong>";
            // ==================== Speaker.bot ========================
            case EventType.SpeakerBotConnected:
                return $"<strong>No description provided</strong>";
            case EventType.SpeakerBotDisconnected:
                return $"<strong>No description provided</strong>";
            // ==================== Speech ========================
            case EventType.SpeechToTextCommand:
                return $"<strong>No description provided</strong>";
            case EventType.SpeechToTextDictation:
                return $"<strong>No description provided</strong>";
            // ==================== StreamElements ========================
            case EventType.StreamElementsAuthenticated:
                return $"<strong>No description provided</strong>";
            case EventType.StreamElementsConnected:
                return $"<strong>No description provided</strong>";
            case EventType.StreamElementsDisconnected:
                return $"<strong>No description provided</strong>";
            case EventType.StreamElementsMerch:
                return $"<strong>No description provided</strong>";
            case EventType.StreamElementsTip:
                return $"<strong>No description provided</strong>";
            // ==================== Streamer.bot ========================
            case EventType.StreamerBotCustomWebook:
                return $"<strong>No description provided</strong>";
            case EventType.StreamerBotRemoteInstanceConnected:
                return $"<strong>No description provided</strong>";
            case EventType.StreamerBotRemoteInstanceDisconnected:
                return $"<strong>No description provided</strong>";
            case EventType.StreamerBotRemoteInstanceSignal:
                return $"<strong>No description provided</strong>";
            case EventType.StreamerBotRemoteInstanceTrigger:
                return $"<strong>No description provided</strong>";
            case EventType.StreamerbotExiting:
                return $"<strong>No description provided</strong>";

            case EventType.StreamerbotStarted:
                CPH.TryGetArg("triggerCategory", out string StreamerbotStarted);                                                                    /* The category of the trigger which executed the action */
                CPH.TryGetArg("isTest", out bool StreamerbotStartedisTest);  /* Test trigger False/True*/
                CPH.TryGetArg("runningActionId", out Guid StreamerbotStartedRunningActionId);                                                       /* The unique ID of this running action instance within the queue */
                CPH.TryGetArg("actionQueuedAt", out DateTime StreamerbotStartedActionQueuedAt);                                                     /* The timestamp of when action was queued */
                CPH.TryGetArg("triggerId", out Guid StreamerbotStartedTriggerId);                                                                   /* The unique id of the trigger with executed the action */
                CPH.TryGetArg("triggerName", out Guid StreamerbotStartedTriggerName);                                                               /* The name of the trigger which executed the action */
                CPH.TryGetArg("actionId", out string StreamerBotStartedActionId);                                                                   /* The unique ID of the action being executed */
                CPH.TryGetArg("actionName", out string StreamerBotStartedActionName);                                                               /* The name of the action being executed */ 
                CPH.TryGetArg("eventSource", out string StreamerBotStartedEventSource);                                                             /* The service of the event which triggered the action.*/
                return $"Streamerbot has <strong> started</strong> and is now running";

            // ==================== Streamlabs ========================
            case EventType.StreamlabsAuthenticated:
                return $"<strong>No description provided</strong>";
            case EventType.StreamlabsCharityDonation:
                return $"<strong>No description provided</strong>";
            case EventType.StreamlabsConnected:
                return $"<strong>No description provided</strong>";
            case EventType.StreamlabsDisconnected:
                return $"<strong>No description provided</strong>";
            case EventType.StreamlabsDonation:
                return $"<strong>No description provided</strong>";
            case EventType.StreamlabsMerchandise:
                return $"<strong>No description provided</strong>";
            // ==================== Streamlabs Desktop ========================
            case EventType.StreamlabsDesktopConnected:
                CPH.TryGetArg("triggerCategory", out string StreamlabsDesktopConnectedTriggerCategory);                                             /* The category of the trigger which executed the action */
                CPH.TryGetArg("isTest", out bool StreamlabsDesktopConnectedisTest);  /* Test trigger False/True*/
                CPH.TryGetArg("runningActionId", out Guid StreamlabsDesktopConnectedRunningActionId);                                               /* The unique ID of this running action instance within the queue */
                CPH.TryGetArg("actionQueuedAt", out DateTime StreamlabsDesktopConnectedActionQueuedAt);                                             /* The timestamp of when action was queued */
                CPH.TryGetArg("triggerId", out Guid StreamlabsDesktopConnectedTriggerId);                                                           /* The unique id of the trigger with executed the action */
                CPH.TryGetArg("triggerName", out Guid StreamlabsDesktopConnectedTriggerName);                                                       /* The name of the trigger which executed the action */
                CPH.TryGetArg("actionId", out string StreamlabsDesktopConnectedActionId);                                                           /* The unique ID of the action being executed */
                CPH.TryGetArg("actionName", out string StreamlabsDesktopConnectedActionName);                                                       /* The name of the action being executed */ 
                CPH.TryGetArg("eventSource", out string StreamlabsDesktopConnectedEventSource);                                                     /* The service of the event which triggered the action.*/
                return $"have been <strong>{StreamlabsDesktopConnectedTriggerName}</strong>";

            case EventType.StreamlabsDesktopDisconnected:
                CPH.TryGetArg("triggerCategory", out string StreamlabsDesktopDisconnectedTriggerCategory);                                          /* The category of the trigger which executed the action */
                CPH.TryGetArg("isTest", out bool StreamlabsDesktopDisconnectedisTest);  /* Test trigger False/True*/
                CPH.TryGetArg("runningActionId", out Guid StreamlabsDesktopDisconnectedRunningActionId);                                            /* The unique ID of this running action instance within the queue */
                CPH.TryGetArg("actionQueuedAt", out DateTime StreamlabsDesktopDisconnectedActionQueuedAt);                                          /* The timestamp of when action was queued */
                CPH.TryGetArg("triggerId", out Guid StreamlabsDesktopDisconnectedTriggerId);                                                        /* The unique id of the trigger with executed the action */
                CPH.TryGetArg("triggerName", out Guid StreamlabsDesktopDisconnectedTriggerName);                                                    /* The name of the trigger which executed the action */
                CPH.TryGetArg("actionId", out string StreamlabsDesktopDisconnectedActionId);                                                        /* The unique ID of the action being executed */
                CPH.TryGetArg("actionName", out string StreamlabsDesktopDisconnectedActionName);                                                    /* The name of the action being executed */ 
                CPH.TryGetArg("eventSource", out string StreamlabsDesktopDisconnectedEventSource);                                                  /* The service of the event which triggered the action.*/
                return $"have been <strong>{StreamlabsDesktopDisconnectedTriggerName}</strong>";

            case EventType.StreamlabsDesktopRecordingStarted:
                return $"<strong>No description provided</strong>";
            case EventType.StreamlabsDesktopRecordingStopped:
                return $"<strong>No description provided</strong>";
            case EventType.StreamlabsDesktopSceneChanged:
                return $"<strong>No description provided</strong>";
            case EventType.StreamlabsDesktopStreamingStarted:
                return $"<strong>No description provided</strong>";
            case EventType.StreamlabsDesktopStreamingStopped:
                return $"<strong>No description provided</strong>";
            // ==================== System ========================
            case EventType.SystemClipboardChanged:
                return $"<strong>No description provided</strong>";
            // ==================== T.I.T.S. ========================
            case EventType.ThrowingSystemConnected:
                return $"<strong>No description provided</strong>";
            case EventType.ThrowingSystemEventsConnected:
                return $"<strong>No description provided</strong>";
            case EventType.ThrowingSystemEventsDisconnected:
                return $"<strong>No description provided</strong>";
            case EventType.ThrowingSystemItemHit:
                return $"<strong>No description provided</strong>";
            case EventType.ThrowingSystemTriggerActivated:
                return $"<strong>No description provided</strong>";
            case EventType.ThrowingSystemTriggerEnded:
                return $"<strong>No description provided</strong>";
            case EventType.ThrowingSystemWebsocketConnected:
                return $"<strong>No description provided</strong>";
            case EventType.ThrowingSystemWebsocketDisconnected:
                return $"<strong>No description provided</strong>";
            // ==================== Timed Actions ========================
           case EventType.TimedAction:
    			CPH.TryGetArg("actionName", out string TimedActionName);                                                                            /* The name of the action being executed */ 
    			CPH.TryGetArg("timerName", out string TimedActiontimerName);
    			CPH.TryGetArg("broadcastUserName", out string TimedActionbroadcastUserName);                                                        /* The Twitch display name of the broadcaster account */
    			CPH.TryGetArg("triggerCategory", out String TimedActionTriggerCategory);                                                            /* The category of the trigger which executed the action */
    			CPH.TryGetArg("isTest", out bool TimedActionIsTest);
    			CPH.TryGetArg("runningActionId", out Guid TimedActionRunningActionId);                                                              /* The unique ID of this running action instance within the queue */
    			CPH.TryGetArg("actionQueuedAt", out DateTime TimedActionActionQueuedAt);                                                            /* The timestamp of when action was queued */
    			CPH.TryGetArg("triggerId", out Guid TimedActionTriggerID);                                                                          /* The unique id of the trigger with executed the action */
    			CPH.TryGetArg("triggerName", out string TimedActionTriggerName);                                                                    /* The name of the trigger which executed the action */
    			CPH.TryGetArg("actionId", out Guid TimedActionActionId);                                                                            /* The unique ID of the action being executed */
    			CPH.TryGetArg("eventSource", out String TimedActionEventSource);                                                                    /* The service of the event which triggered the action.*/
    			CPH.TryGetArg("counter", out string TimedActionCounter);
    			CPH.TryGetArg("rawInput", out string TimedActionRawInput);
    			CPH.TryGetArg("rawInputEscaped", out string TimedActionRawInputEscaped);
    			CPH.TryGetArg("message", out string TimedActionMessage); 
    			CPH.TryGetArg("isInSharedChat", out bool TimedActionisInSharedChat);
    			CPH.TryGetArg("isSharedChatHost", out bool TimedActionIsSharedChatHost);
    			CPH.TryGetArg("isFromSharedChatGuest", out bool TimedActionIsFromSharedChatGuest);
    			CPH.TryGetArg("firstMessage", out bool TimedActionFirstMessage);
    			CPH.TryGetArg("returningChatter", out bool TimedActionReturningChatter);
    			CPH.TryGetArg("badgeCount", out int TimedActionBadgeCount); 
    			CPH.TryGetArg("bits", out int TimedActionBits); 
    			CPH.TryGetArg("role", out int TimedActionRole); 
    			CPH.TryGetArg("emoteCount", out int TimedActionEmoteCount);
    			CPH.TryGetArg("input0", out string TimedActionInput0); 
    			CPH.TryGetArg("inputEscaped0", out string TimedActionInputEscaped0);
    			CPH.TryGetArg("inputUrlEncoded0", out string TimedActionInputUrlEncoded0);
    			CPH.TryGetArg("input1", out string TimedActionInput1);
    			CPH.TryGetArg("inputEscaped1", out string TimedActionInputEscaped1);
    			CPH.TryGetArg("inputUrlEncoded1", out string TimedActionInputUrlEncoded1);
    			CPH.TryGetArg("input2", out string TimedActionInput2);
    			CPH.TryGetArg("inputEscaped2", out string TimedActionInputEscaped2);
    			CPH.TryGetArg("inputUrlEncoded2", out string TimedActionInputUrlEncoded2);
    			CPH.TryGetArg("input3", out string TimedActionInput3);
    			CPH.TryGetArg("inputEscaped3", out string TimedActionInputEscaped3);
    			CPH.TryGetArg("inputUrlEncoded3", out string TimedActionInputUrlEncoded3);
    			CPH.TryGetArg("input4", out string TimedActionInput4);
    			CPH.TryGetArg("inputEscaped4", out string TimedActionInputEscaped4);
    			CPH.TryGetArg("inputUrlEncoded4", out string TimedActionInputUrlEncoded4);
    			CPH.TryGetArg("input5", out string TimedActionInput5);
    			CPH.TryGetArg("inputEscaped5", out string TimedActionInputEscaped5);
    			CPH.TryGetArg("inputUrlEncoded5", out string TimedActionInputUrlEncoded5);

				string timedResult = $"Timer <strong>{TimedActiontimerName}</strong> activated Actiongroup: <strong>• {TimedActionName} •</strong>";
    			if (!string.IsNullOrEmpty(TimedActionMessage))
    				{
        			timedResult += $" Message: '{TimedActionMessage}'";
    				}

    			if (TimedActionIsTest)
    				{
        			timedResult += ". Test trigger: True";
    				}

    			return timedResult;
    

            // ==================== TipeeeStream ========================
            case EventType.TipeeeStreamDonation:
                return $"<strong>No description provided</strong>";
            // ==================== Toast ========================
            case EventType.ToastActivation:
                return $"<strong>No description provided</strong>";
            // ==================== TreatStream ========================
            case EventType.TreatStreamAuthenticated:
                return $"<strong>No description provided</strong>";
            case EventType.TreatStreamConnected:
                return $"<strong>No description provided</strong>";
            case EventType.TreatStreamDisconnected:
                return $"<strong>No description provided</strong>";
            case EventType.TreatStreamTreat:
                return $"<strong>No description provided</strong>";
            // ==================== Trovo ========================
            case EventType.TrovoBroadcasterAuthenticated:
                return $"<strong>No description provided</strong>";
            case EventType.TrovoBroadcasterChatConnected:
                return $"<strong>No description provided</strong>";
            case EventType.TrovoBroadcasterChatDisconnected:
                return $"<strong>No description provided</strong>";
            case EventType.TrovoChatMessage:
                return $"<strong>No description provided</strong>";
            case EventType.TrovoCustomSpellCast:
                return $"<strong>No description provided</strong>";
            case EventType.TrovoFirstWords:
                return $"<strong>No description provided</strong>";
            case EventType.TrovoFollow:
                return $"<strong>No description provided</strong>";
            case EventType.TrovoGiftSubscription:
                return $"<strong>No description provided</strong>";
            case EventType.TrovoMassGiftSubscription:
                return $"<strong>No description provided</strong>";
            case EventType.TrovoPresentViewers:
                return $"<strong>📊 Present viewers check</strong>";
            case EventType.TrovoRaid:
                return $"<strong>No description provided</strong>";
            case EventType.TrovoResubscription:
                return $"<strong>No description provided</strong>";
            case EventType.TrovoSpellCast:
                return $"<strong>No description provided</strong>";
            case EventType.TrovoStreamOffline:
                return $"<strong>No description provided</strong>";
            case EventType.TrovoStreamOnline:
                return $"<strong>No description provided</strong>";
            case EventType.TrovoSubscription:
                return $"<strong>No description provided</strong>";

            // ==================== Twitch ========================                
            case EventType.TwitchAdRun:
                CPH.TryGetArg("adLength", out string TwitchAdRunAdLength);                                                                          /* The length of the ad in seconds */
                CPH.TryGetArg("adLengthMs", out string TwitchAdRunAdLengthMs);                                                                      /* The length of the ad in milliseconds */
                CPH.TryGetArg("adScheduled", out bool TwitchAdRunAdScheduled);                                                                      /* Is the ad scheduled? */
                return $"📺 Ad Break for <strong>{TwitchAdRunAdLength}</strong> seconds • Scheduled: <strong>{TwitchAdRunAdScheduled}</strong>";

            case EventType.TwitchAnnouncement:
                CPH.TryGetArg("isTest", out bool TwitchAnnouncementIsTest);
                CPH.TryGetArg("fromSharedChat", out bool TwitchAnnouncementFromSharedChat);
                CPH.TryGetArg("role", out string TwitchAnnouncementRole);
                CPH.TryGetArg("announceColor", out string TwitchAnnouncementAnnounceColor);
                CPH.TryGetArg("message", out string TwitchAnnouncementMessage);
                return $"<strong>{TwitchAnnouncementMessage}</strong> • SharedChat Announcement: {TwitchAnnouncementFromSharedChat}";

            case EventType.TwitchAutomaticRewardRedemption:
                CPH.TryGetArg("counter", out int TwitchAutomaticRewardRedemptionCounter);
                CPH.TryGetArg("userName", out string TwitchAutomaticRewardRedemptionUserName);
                CPH.TryGetArg("rewardCost", out int TwitchAutomaticRewardRedemptionRewardCost);
                CPH.TryGetArg("rewardType", out string TwitchAutomaticRewardRedemptionRewardType);
                return $"<strong>{TwitchAutomaticRewardRedemptionUserName}</strong> redeem {TwitchAutomaticRewardRedemptionRewardType} for {TwitchAutomaticRewardRedemptionRewardCost} points";

            case EventType.TwitchAutoModMessageHeld:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchAutoModMessageUpdate:
                return $"<strong>No description provided</strong>";

            case EventType.TwitchBetterTTVEmoteAdded:
                CPH.TryGetArg("isTest", out bool TwitchBetterTTVEmoteAddedIsTest);
                CPH.TryGetArg("emote", out string TwitchBetterTTVEmoteAddedEmote);
                CPH.TryGetArg("imageUrl", out String TwitchBetterTTVEmoteAddedImageUrl);
                return $"A new BTTV Emote has been added: <strong>{TwitchBetterTTVEmoteAddedEmote}</strong> <img src=\"{TwitchBetterTTVEmoteAddedImageUrl}\" alt=\"{TwitchBetterTTVEmoteAddedEmote}\" style=\"height: 28px; vertical-align: middle;\" />";


                return $"<strong>No description provided</strong>";
            case EventType.TwitchBetterTTVEmoteRemoved:
                return $"<strong>No description provided</strong>";

            case EventType.TwitchBitsBadgeTier:
                CPH.TryGetArg("user", out bool TwitchBitsBadgeTierUser);
                return $"{TwitchBitsBadgeTierUser} upgraded their <strong>Bit Tier </strong>";


            case EventType.TwitchBlockedTermsAdded:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchBlockedTermsDeleted:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchBotEventSubConnected:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchBotEventSubDisconnected:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchBotWhisper:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchBroadcasterAuthenticated:
                return $"<strong>No description provided</strong>";

            case EventType.TwitchBroadcasterChatConnected:
                CPH.TryGetArg("triggerCategory", out string TwitchBroadcasterChatConnectedTrigger);                                                 /* The category of the trigger which executed the action */
                CPH.TryGetArg("isTest", out bool TwitchBroadcasterChatConnectedIsTest);  
                CPH.TryGetArg("broadcasterIsOnboarded", out bool TwitchBroadcasterChatConnectedbroadcasterIsOnboarded);
                CPH.TryGetArg("runningActionId", out Guid TwitchBroadcasterChatConnectedRunningActionId);                                           /* The unique ID of this running action instance within the queue */
                CPH.TryGetArg("actionQueuedAt", out DateTime TwitchBroadcasterChatConnectedActionQueuedAt);                                         /* The timestamp of when action was queued */
                CPH.TryGetArg("triggerId", out Guid TwitchBroadcasterChatConnectedTriggerId);                                                       /* The unique id of the trigger with executed the action */
                CPH.TryGetArg("triggerName", out string TwitchBroadcasterChatConnectedTriggerName);                                                 /* The name of the trigger which executed the action */
                CPH.TryGetArg("actionId", out Guid TwitchBroadcasterChatConnectedActionId);                                                         /* The unique ID of the action being executed */
                CPH.TryGetArg("actionName", out string TwitchBroadcasterChatConnectedactionActionName);                                             /* The name of the action being executed */ 
                CPH.TryGetArg("eventSource", out string TwitchBroadcasterChatConnectedEventSource);                                                 /* The service of the event which triggered the action.*/
                CPH.TryGetArg("broadcastUser", out string TwitchBroadcasterChatConnectedBroadcastUser);                                             /* The Twitch display name of the broadcaster account */
                CPH.TryGetArg("broadcastUserName", out string TwitchBroadcasterChatConnectedBroadcastUserName);                                     /* The Twitch user name of the broadcaster account */
                CPH.TryGetArg("broadcastUserId", out string TwitchBroadcasterChatConnectedBroadcastUserId);                                         /* The Twitch user ID of the broadcaster account */
                CPH.TryGetArg("broadcasterIsAffiliate", out bool TwitchBroadcasterChatConnectedBroadcasterIsAffiliate);                             /* Is the broadcaster an affiliate? */
                CPH.TryGetArg("broadcasterIsPartner", out bool TwitchBroadcasterChatConnectedBroadcasterIsPartner);                                 /* Is the broadcaster an partner ? */
                CPH.TryGetArg("rawInputEscaped", out string TwitchBroadcasterChatConnectedrawInputEscaped);
                CPH.TryGetArg("message", out string TwitchBroadcasterChatConnectedmessage);
                return $"Chat is <strong>Connected</strong>";


            case EventType.TwitchBroadcasterChatDisconnected:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchBroadcasterEventSubConnected:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchBroadcasterEventSubDisconnected:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchBroadcastUpdate:
                return $"<strong>No description provided</strong>";

            case EventType.TwitchCharityCompleted:
                CPH.TryGetArg("charity.name", out string TwitchCharityCompletedName);
                CPH.TryGetArg("charity.description", out string TwitchCharityCompletedDescription);
                CPH.TryGetArg("charity.website", out string TwitchCharityCompletedWebsite);
                CPH.TryGetArg("charity.currentAmount.value", out string TwitchCharityCompletedCurrentValue);
                CPH.TryGetArg("charity.currentAmount.currency", out string TwitchCharityCompletedCurrentCurrency);
                CPH.TryGetArg("charity.targetAmount.value", out string TwitchCharityCompletedTargetValue);
                CPH.TryGetArg("charity.targetAmount.currency", out string TwitchCharityCompletedTargetCurrency);
                return $"{TwitchCharityCompletedName} Charity have been completed <strong>Goal</strong> {TwitchCharityCompletedTargetValue} {TwitchCharityCompletedTargetCurrency}";

            case EventType.TwitchCharityDonation:
                CPH.TryGetArg("charity.name", out string TwitchCharityDonationName);
                CPH.TryGetArg("charity.description", out string TwitchCharityDonationDescription);
                CPH.TryGetArg("charity.website", out string TwitchCharityDonationWebsite);
                CPH.TryGetArg("charity.amount.value", out string TwitchCharityDonationAmountValue);
                CPH.TryGetArg("charity.amount.currency", out string TwitchCharityDonationAmountCurrency);
                CPH.TryGetArg("userName", out string TwitchCharityDonationUserName);
                return $"{TwitchCharityDonationUserName} Donate to charity <strong>{TwitchCharityDonationName}</strong> {TwitchCharityDonationAmountCurrency} {TwitchCharityDonationAmountValue}";

            case EventType.TwitchCharityProgress:
                CPH.TryGetArg("charity.name", out string TwitchCharityProgressCharityName);
                CPH.TryGetArg("charity.description", out string TwitchCharityProgressCharityDescription);
                CPH.TryGetArg("charity.website", out string TwitchCharityProgressCharityWebsite);
                CPH.TryGetArg("charity.currentAmount.value", out string TwitchCharityProgressCharityCurrentValue);
                CPH.TryGetArg("charity.currentAmount.currency", out string TwitchCharityProgressCharityCurrentCurrency);
                CPH.TryGetArg("charity.targetAmount.value", out string TwitchCharityProgressCharityTargetValue);
                CPH.TryGetArg("charity.targetAmount.currency", out string TwitchCharityProgressCharityTargetCurrency);
                return $"{TwitchCharityProgressCharityName} Updated {TwitchCharityProgressCharityCurrentCurrency} {TwitchCharityProgressCharityCurrentValue} <strong>Target</strong> {TwitchCharityProgressCharityTargetCurrency} {TwitchCharityProgressCharityTargetValue}";

            case EventType.TwitchCharityStarted:
                CPH.TryGetArg("triggerCategory", out string TwitchCharityStartedTriggerCategory);                                                   /* The category of the trigger which executed the action */
                CPH.TryGetArg("broadcasterIsOnboarded", out string TwitchCharityStartedBroadcasterIsOnboarded);
                CPH.TryGetArg("charity.name", out string TwitchCharityStartedCharityName);
                CPH.TryGetArg("charity.logo", out string TwitchCharityStartedCharityLogo);
                CPH.TryGetArg("charity.website", out string TwitchCharityStartedCharityWebsite);
                CPH.TryGetArg("charity.currentAmount.value", out string TwitchCharityStartedCharityCurrentAmountValue);
                CPH.TryGetArg("charity.currentAmount.valueMinor", out string TwitchCharityStartedCharityCurrentAmountValueMinor);
                CPH.TryGetArg("charity.currentAmount.currency", out string TwitchCharityStartedCharityCurrentAmountCurrency);
                CPH.TryGetArg("charity.targetAmount.value", out string TwitchCharityStartedCharityTargetAmountValue);
                CPH.TryGetArg("charity.targetAmount.valueMinor", out string TwitchCharityStartedCharityTargetAmountValueMinor);
                CPH.TryGetArg("charity.targetAmount.currency", out string TwitchCharityStartedCharityTargetAmountCurrency);
                CPH.TryGetArg("eventSource", out string TwitchCharityStartedEventSource);                                                           /* The service of the event which triggered the action.*/
                return $"{TwitchCharityStartedCharityName} <strong>Started</strong> {TwitchCharityStartedCharityTargetAmountCurrency} {TwitchCharityStartedCharityTargetAmountValue}";
                
            case EventType.TwitchChatCleared:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchChatEmoteModeOff:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchChatEmoteModeOn:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchChatFollowerModeChanged:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchChatFollowerModeOff:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchChatFollowerModeOn:
                return $"<strong>No description provided</strong>";

            case EventType.TwitchChatMessage:
                CPH.TryGetArg("message", out string TwitchChatMessageMessage);
                CPH.TryGetArg("user", out string TwitchChatMessageUser);
                CPH.TryGetArg("userType", out string TwitchChatMessageUserType);
                return $"{TwitchChatMessageUser} <strong>Say</strong> {TwitchChatMessageMessage}";

            case EventType.TwitchChatMessageDeleted:
                CPH.TryGetArg("user", out string TwitchChatMessageDeletedUser);
                CPH.TryGetArg("message", out string TwitchChatMessageDeletedMessage);
                return $"{TwitchChatMessageDeletedUser}<strong>Message deleted</strong> {TwitchChatMessageDeletedMessage}";

            case EventType.TwitchChatSlowModeChanged:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchChatSlowModeOff:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchChatSlowModeOn:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchChatSubscriberModeOff:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchChatSubscriberModeOn:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchChatUniqueModeOff:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchChatUniqueModeOn:
                return $"<strong>No description provided</strong>";

            case EventType.TwitchCheer:
                CPH.TryGetArg("user", out string TwitchCheerUser);
                CPH.TryGetArg("bits", out int TwitchCheerBits);
                CPH.TryGetArg("message", out string TwitchCheerMsg);
                CPH.TryGetArg("messageCheermotesStripped", out string TwitchCheermessageCheermotesStripped);

                // --- 1. Logic to determine the Bit Image URL ---
                string bitColor = "gray";
                if (TwitchCheerBits >= 100) bitColor = "purple";
                if (TwitchCheerBits >= 1000) bitColor = "green";
                if (TwitchCheerBits >= 5000) bitColor = "blue";
                if (TwitchCheerBits >= 10000) bitColor = "red";
                if (TwitchCheerBits >= 100000) bitColor = "gold";

                string cheerUrl;
                if (!CPH.TryGetArg("cheerEmoteUrl", out cheerUrl) || string.IsNullOrEmpty(cheerUrl))
                {
                cheerUrl = $"https://static-cdn.jtvnw.net/bits/dark/animated/{bitColor}/2";
                }

                // --- 2. Prepare the message part conditionally ---
                string finalMsgDisplay = "";

                // We check if the stripped message is NOT empty and NOT just spaces
                if (!string.IsNullOrWhiteSpace(TwitchCheermessageCheermotesStripped))
                {
                // If there is text, we format it with the separator and the word "message"
                // You can change " • message " to just " • " if you prefer
                finalMsgDisplay = $" • message • {TwitchCheermessageCheermotesStripped}";
                }

                // If the message was empty, this adds nothing.
                return $"<strong>{TwitchCheerUser}</strong> <img src=\"{cheerUrl}\" alt=\"{TwitchCheerBits}\" style=\"height: 28px; vertical-align: middle;\" /> {TwitchCheerBits} bits{finalMsgDisplay}";

            case EventType.TwitchCoinCheer:
                return $"<strong>No description provided</strong>";
                

            case EventType.TwitchCommunityGoalContribution:
                CPH.TryGetArg("user", out string TwitchCommunityGoalContributionUser);
                CPH.TryGetArg("userId", out string TwitchCommunityGoalContributionUserId);
                CPH.TryGetArg("isTest", out bool TwitchCommunityGoalContributionIsTest);
                CPH.TryGetArg("durationDays", out int TwitchCommunityGoalContributionDurationDays);
                CPH.TryGetArg("daysLeft", out string TwitchCommunityGoalContributionDaysLeft);
                CPH.TryGetArg("goalAmount", out int TwitchCommunityGoalContributionGoalAmount);
                CPH.TryGetArg("percentComplete", out string TwitchCommunityGoalContributionPercent);
                CPH.TryGetArg("userContributed", out int TwitchCommunityGoalContributionUserContributed);
                CPH.TryGetArg("userTotalContributed", out int TwitchCommunityGoalContributionUserTotalContributed);
                CPH.TryGetArg("contributed", out int TwitchCommunityGoalContributionContributed);
                CPH.TryGetArg("title", out string TwitchCommunityGoalContributionTitle);
                CPH.TryGetArg("userName", out string TwitchCommunityGoalContributionUserName);
                CPH.TryGetArg("runningActionId", out string TwitchCommunityGoalContributionRunningActionId);                                        /* The unique ID of this running action instance within the queue */
                CPH.TryGetArg("actionQueuedAt", out DateTime TwitchCommunityGoalContributionActionQueuedAt);                                        /* The timestamp of when action was queued */
                CPH.TryGetArg("triggerId", out Guid TwitchCommunityGoalContributionTriggerId);                                                      /* The unique id of the trigger with executed the action */
                CPH.TryGetArg("triggerName", out string TwitchCommunityGoalContributionTriggerName);                                                /* The name of the trigger which executed the action */
                CPH.TryGetArg("actionId", out Guid TwitchCommunityGoalContributionActionId);                                                        /* The unique ID of the action being executed */
                CPH.TryGetArg("actionName", out string TwitchCommunityGoalContributionActionName);                                                  /* The name of the action being executed */ 
                CPH.TryGetArg("userType", out string TwitchCommunityGoalContributionUserType);
                CPH.TryGetArg("userGroups", out string TwitchCommunityGoalContributionUserGroup);
                CPH.TryGetArg("isSubscribed", out bool TwitchCommunityGoalContributionIsSubscribed);
                CPH.TryGetArg("isModerator", out bool TwitchCommunityGoalContributionIsModerator);
                CPH.TryGetArg("isVip", out bool TwitchCommunityGoalContributionIsVip);
                CPH.TryGetArg("userPreviousActive", out DateTime TwitchCommunityGoalContributionUserPreviousActive);
                CPH.TryGetArg("eventSource", out string TwitchCommunityGoalContributionEventSource);                                                /* The service of the event which triggered the action.*/
                CPH.TryGetArg("broadcastUser", out string TwitchCommunityGoalContributionBroadcastUser);                                            /* The Twitch display name of the broadcaster account */
                CPH.TryGetArg("broadcastUserName", out string TwitchCommunityGoalContributionBroadcastUserName);                                    /* The Twitch user name of the broadcaster account */
                CPH.TryGetArg("broadcastUserId", out string TwitchCommunityGoalContributionBroadcastUserID);                                        /* The Twitch user ID of the broadcaster account */
                CPH.TryGetArg("broadcasterIsAffiliate", out bool TwitchCommunityGoalContributionBroadcasterIsAffiliate);                            /* Is the broadcaster an affiliate? */
                CPH.TryGetArg("broadcasterIsPartner", out bool TwitchCommunityGoalContributionBroadcasterIsPartner);                                /* Is the broadcaster an partner ? */
                return $"{TwitchCommunityGoalContributionUserName} Contributed {TwitchCommunityGoalContributionContributed} points<strong> Days Left </strong>{TwitchCommunityGoalContributionDaysLeft}";

            case EventType.TwitchCommunityGoalEnded:
                CPH.TryGetArg("title", out string TwitchCommunityGoalEndedtitle);
                CPH.TryGetArg("goalAmount", out string TwitchCommunityGoalEndedGoalAmount);
                CPH.TryGetArg("contributed", out string TwitchCommunityGoalEndedContributed);
                CPH.TryGetArg("percentComplete", out string TwitchCommunityGoalEndedpercent);
                return $" {TwitchCommunityGoalEndedtitle} Goal Ended, contributed {TwitchCommunityGoalEndedContributed} Percent completed <strong>{TwitchCommunityGoalEndedpercent}</strong> of total armount {TwitchCommunityGoalEndedGoalAmount}";

            case EventType.TwitchFirstWord:
                CPH.TryGetArg("message", out string TwitchFirstWordChatMessage);
                CPH.TryGetArg("isHighlight", out bool TwitchFirstWordMessageisHighlight);
                CPH.TryGetArg("isReply", out bool TwitchFirstWordMessageisReply);
                CPH.TryGetArg("user", out string TwitchFirstWordChatMessageUser);
                CPH.TryGetArg("firstMessage", out string TwitchFirstWordFirstMessage);
                return $"<strong>No description provided</strong>";

            case EventType.TwitchFollow:
                CPH.TryGetArg("user", out string followUser);
                return $"<strong>{followUser}</strong> followed the channel";

            case EventType.TwitchGiftBomb:
                CPH.TryGetArg("user", out string TwitchGiftBombUser);
                CPH.TryGetArg("gifts", out int TwitchGiftBombGifts);
                CPH.TryGetArg("tier", out string TwitchGiftBombTier);
                return $"{TwitchGiftBombUser}<strong>gifted {TwitchGiftBombGifts} with tier {TwitchGiftBombTier} </strong>";


            case EventType.TwitchGiftPaidUpgrade:
                return $"<strong>No description provided</strong>";

            case EventType.TwitchGiftSub:
                CPH.TryGetArg("user", out string TwitchGiftSubGifter);
                CPH.TryGetArg("recipientUser", out string TwitchGiftSubRecipient);
                CPH.TryGetArg("tier", out string TwitchGiftSubTier);
                return $"<strong>{TwitchGiftSubGifter}</strong> gifted a sub to <strong>{TwitchGiftSubRecipient}</strong> {TwitchGiftSubTier}";

            case EventType.TwitchGoalBegin:
                CPH.TryGetArg("goal.currentAmount", out string TwitchGoalBeginGoalCurrentAmount);                                                       /* The current amount of this channel goal */
                CPH.TryGetArg("goal.description", out string TwitchGoalBeginGoalDescription);                                                           /* The description of this channel goal */
                CPH.TryGetArg("goal.id", out string TwitchGoalBeginGoalId);                                                                             /* The unique id of this channel goal */
                CPH.TryGetArg("goal.startedAt", out DateTime TwitchGoalBeginGoalStartedAt);                                                             /* The timestamp that the channel goal started */
                CPH.TryGetArg("goal.targetAmount", out string TwitchGoalBeginGoalTargetAmount);                                                         /* The target of this channel goal */
                CPH.TryGetArg("goal.type", out string TwitchGoalBeginGoalType);                                                                         /* The type of this channel goal */
                return $"<strong>No description provided</strong>";

            case EventType.TwitchGoalEnd:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchGoalProgress:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchGuestStarGuestUpdate:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchGuestStarSessionBegin:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchGuestStarSessionEnd:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchGuestStarSettingsUpdate:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchGuestStarSlotUpdate:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchHypeChat:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchHypeChatLevel:
                return $"<strong>No description provided</strong>";

            case EventType.TwitchHypeTrainEnd:
                CPH.TryGetArg("user", out string TwitchHypeTrainEndUser);
                CPH.TryGetArg("percentDecimal", out decimal TwitchHypeTrainEndPercentDecimal);
                CPH.TryGetArg("level", out int TwitchHypeTrainEndLevel);
                CPH.TryGetArg("contributors", out string TwitchHypeTrainEndContributors);
                CPH.TryGetArg("top.bits.user", out string TwitchHypeTrainEndTopBitsUser);
                CPH.TryGetArg("top.bits.total", out int TwitchHypeTrainEndTopBitsTotal);
                return $"<strong>No description provided</strong>";

            case EventType.TwitchHypeTrainLevelUp:
                CPH.TryGetArg("user", out string TwitchHypeTrainLevelUpUser);
                CPH.TryGetArg("percentDecimal", out decimal TwitchHypeTrainLevelUpPercentDecimal);
                CPH.TryGetArg("level", out int TwitchHypeTrainLevelUpLevel);
                return $"<strong>No description provided</strong>";

            case EventType.TwitchHypeTrainStart:
                CPH.TryGetArg("user", out string TwitchHypeTrainStartUser);
                return $"<strong>No description provided</strong>";

            case EventType.TwitchHypeTrainUpdate:
                CPH.TryGetArg("user", out string TwitchHypeTrainUpdateUser);
                CPH.TryGetArg("percentDecimal", out decimal TwitchHypeTrainUpdatePercentDecimal);
                CPH.TryGetArg("level", out int TwitchHypeTrainUpdateLevel);
                return $"<strong>No description provided</strong>";

            case EventType.TwitchModeratorAdded:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchModeratorRemoved:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchPayItForward:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchPermittedTermsAdded:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchPermittedTermsDeleted:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchPollArchived:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchPollCompleted:
                {
                    CPH.TryGetArg("poll.Title", out string title);
                    CPH.TryGetArg("poll.choices.count", out int choiceCount);
                    CPH.TryGetArg("poll.winningChoice.id", out string winningChoiceID);
                    CPH.TryGetArg("poll.totalVotes", out int totalVotes);

                    // Construct a list of choices
                    List<JObject> choices = new List<JObject>();
                    for (int i = 0; i < choiceCount; i++)
                    {
                        JObject choice = new JObject();

                        CPH.TryGetArg($"poll.choice{i}.id", out string choiceID);
                        CPH.TryGetArg($"poll.choice{i}.title", out string choiceTitle);
                        CPH.TryGetArg($"poll.choice{i}.totalVotes", out int choiceVotes);
                        choice["id"] = choiceID;
                        choice["title"] = choiceTitle;
                        choice["totalVotes"] = choiceVotes;

                        choices.Add(choice);
                    }
                    return $"<strong>No description provided</strong>";
                }

            case EventType.TwitchPollCreated:
                {
                    CPH.TryGetArg("poll.Title", out string TwitchPollCreatedTitle);
                    CPH.TryGetArg("poll.Duration", out int TwitchPollCreatedDuration);
                    CPH.TryGetArg("poll.choices.count", out int TwitchPollCreatedChoiceCount);

                    // Construct a list of choices
                    List<JObject> choices = new List<JObject>();
                    for (int i = 0; i < TwitchPollCreatedChoiceCount; i++)
                    {
                        JObject choice = new JObject();

                        CPH.TryGetArg($"poll.choice{i}.id", out string choiceID);
                        CPH.TryGetArg($"poll.choice{i}.title", out string choiceTitle);
                        choice["id"] = choiceID;
                        choice["title"] = choiceTitle;

                        choices.Add(choice);
                    }
                    return $"<strong>No description provided</strong>";
                }

            case EventType.TwitchPollTerminated:
                return $"<strong>No description provided</strong>";

            case EventType.TwitchPollUpdated:
                return $"<strong>No description provided</strong>";

            case EventType.TwitchPowerUp:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchPredictionCanceled:
                return $"<strong>No description provided</strong>";

            case EventType.TwitchPredictionCompleted:
                {
                    CPH.TryGetArg("prediction.Title", out string title);
                    CPH.TryGetArg("prediction.winningOutcome.id", out string winningOutcomeID);

                    int totalPoints = 0;

                    List<JObject> outcomes = new List<JObject>();
                    for (int i = 0; i < 10; i++)
                    {
                        JObject outcome = new JObject();

                        CPH.TryGetArg($"prediction.outcome{i}.id", out string outcomeID);

                        // Exit loop if outcome doesn't exist
                        if (string.IsNullOrEmpty(outcomeID))
                            break;

                        CPH.TryGetArg($"prediction.outcome{i}.title", out string outcomeTitle);
                        CPH.TryGetArg($"prediction.outcome{i}.points", out int outcomePoints);
                        outcome["id"] = outcomeID;
                        outcome["title"] = outcomeTitle;
                        outcome["points"] = outcomePoints;

                        outcomes.Add(outcome);

                        totalPoints += outcomePoints;
                    }
                    return $"<strong>No description provided</strong>";
                }

            case EventType.TwitchPredictionCreated:
                {
                    CPH.TryGetArg("prediction.Title", out string TwitchPredictionCreatedTitle);
                    CPH.TryGetArg("prediction.PredictionWindow", out int TwitchPredictionCreatedPredictionWindow);

                    List<JObject> outcomes = new List<JObject>();
                    for (int i = 0; i < 10; i++)
                    {
                        JObject outcome = new JObject();

                        CPH.TryGetArg($"prediction.outcome{i}.id", out string outcomeID);

                        // Exit loop if outcome doesn't exist
                        if (string.IsNullOrEmpty(outcomeID))
                            break;

                        CPH.TryGetArg($"prediction.outcome{i}.title", out string outcomeTitle);
                        outcome["id"] = outcomeID;
                        outcome["title"] = outcomeTitle;

                        outcomes.Add(outcome);
                    }
                    return $"<strong>No description provided</strong>";
                }


            case EventType.TwitchPredictionLocked:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchPredictionUpdated:
                return $"<strong>No description provided</strong>";

            case EventType.TwitchPresentViewers:
                CPH.TryGetArg("triggerCategory", out string TwitchPresentViewersTriggerCategory);                                                   /* The category of the trigger which executed the action */
                CPH.TryGetArg("broadcasterIsOnboarded", out bool TwitchPresentViewersbroadcasterIsOnboarded); /*False/True*/
                CPH.TryGetArg("runningActionId", out Guid TwitchPresentViewersRunningActionId);                                                     /* The unique ID of this running action instance within the queue */
                CPH.TryGetArg("actionQueuedAt", out DateTime TwitchPresentViewersActionQueuedAt);                                                   /* The timestamp of when action was queued */
                CPH.TryGetArg("triggerId", out Guid TwitchPresentViewersTriggerId);                                                                 /* The unique id of the trigger with executed the action */
                CPH.TryGetArg("triggerName", out string TwitchPresentViewersTriggerName);                                                           /* The name of the trigger which executed the action */
                CPH.TryGetArg("actionId", out Guid TwitchPresentViewersActionId);                                                                   /* The unique ID of the action being executed */
                CPH.TryGetArg("actionName", out string TwitchPresentViewersActionName);                                                             /* The name of the action being executed */ 
                CPH.TryGetArg("isLive", out bool TwitchPresentViewersIslive); /*False*/
                CPH.TryGetArg("eventSource", out string TwitchPresentViewersEventSource);                                                           /* The service of the event which triggered the action.*/
                CPH.TryGetArg("broadcastUser", out string TwitchPresentViewersBroadcastUser);                                                       /* The Twitch display name of the broadcaster account */
                CPH.TryGetArg("broadcastUserName", out string TwitchPresentViewersBroadcastUserName);                                               /* The Twitch user name of the broadcaster account */
                CPH.TryGetArg("broadcastUserId", out string TwitchPresentViewersBroadcastUserId);                                                   /* The Twitch user ID of the broadcaster account */
                CPH.TryGetArg("broadcasterIsAffiliate", out bool TwitchPresentViewersBroadcasterIsAffiliate);                                       /* Is the broadcaster an affiliate? */
                CPH.TryGetArg("broadcasterIsPartner", out bool TwitchPresentViewersBroadcasterIsPartner);                                           /* Is the broadcaster an partner ? */
                return $"📊 {TwitchPresentViewersTriggerName} by <strong>{TwitchPresentViewersActionName}</strong>";


            case EventType.TwitchPrimePaidUpgrade:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchPyramidBroken:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchPyramidSuccess:
                return $"<strong>No description provided</strong>";

            case EventType.TwitchRaid:
                CPH.TryGetArg("user", out string TwitchRaidUser);
                CPH.TryGetArg("viewers", out int TwitchRaidViewers);
                return $"<strong>No description provided</strong>";

            case EventType.TwitchRaidCancelled:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchRaidSend:
                return $"<strong>No description provided</strong>";

            case EventType.TwitchRaidStart:
                CPH.TryGetArg("broadcastUser", out string TwitchRaidStartbroadcastUser);                                                            /* The Twitch display name of the broadcaster account */
                CPH.TryGetArg("raidUser", out string TwitchRaidStartraidUser);
                CPH.TryGetArg("raidUserProfileImageUrl", out string TwitchRaidStartRaidUserProfileImageUrl);
                CPH.TryGetArg("viewers", out int TwitchRaidStartViewers);
                return $"<strong>No description provided</strong>";

            case EventType.TwitchReSub:
                CPH.TryGetArg("user", out string TwitchReSubresubUser);
                CPH.TryGetArg("tier", out string TwitchReSubresubTier);
                CPH.TryGetArg("isTest", out string TwitchReSubmonths);
                CPH.TryGetArg("monthStreak", out int TwitchReSubmonthStreak);
                CPH.TryGetArg("cumulative", out int TwitchReSubcumulative);
                CPH.TryGetArg("rawInput", out string TwitchReSubrawInput);
                return $"<strong>{TwitchReSubresubUser}</strong> resubscribed for <span style=\"color:#ff4500\">{TwitchReSubmonths} months</span> (Tier {TwitchReSubresubTier})";

            case EventType.TwitchRewardCreated:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchRewardDeleted:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchRewardRedemption:
                CPH.TryGetArg("user", out string TwitchRewardRedemptionUser);
                CPH.TryGetArg("rewardName", out string TwitchRewardRedemptionRewardName);
                CPH.TryGetArg("rewardCost", out int TwitchRewardRedemptionRewardCost);
                CPH.TryGetArg("rawInput", out string TwitchRewardRedemptionRawInput);
                return $"<strong>No description provided</strong>";

            case EventType.TwitchRewardRedemptionUpdated:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchRewardUpdated:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchSevenTVEmoteAdded:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchSevenTVEmoteRemoved:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchSharedChatAnnouncement:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchSharedChatCommunitySubGift:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchSharedChatGiftPaidUpgrade:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchSharedChatMessageDeleted:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchSharedChatPayItForward:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchSharedChatPrimePaidUpgrade:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchSharedChatRaid:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchSharedChatResub:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchSharedChatSessionBegin:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchSharedChatSessionEnd:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchSharedChatSessionUpdate:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchSharedChatSub:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchSharedChatSubGift:
                return $"<strong>No description provided</strong>";

            case EventType.TwitchSharedChatUserBanned:
                CPH.TryGetArg("user", out string TwitchSharedChatUserBanneduser);
                CPH.TryGetArg("createdByDisplayName", out string TwitchSharedChatUserBannedcreatedByDisplayName);
                CPH.TryGetArg("reason", out string TwitchSharedChatUserBannedreason);
                return $"<strong>No description provided</strong>";

            case EventType.TwitchSharedChatUserTimedout:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchSharedChatUserUnbanned:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchSharedChatUserUntimedout:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchShieldModeBegin:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchShieldModeEnd:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchShoutoutCreated:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchShoutoutReceived:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchStreamOffline:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchStreamOnline:
                return $"<strong>No description provided</strong>";

            case EventType.TwitchStreamUpdate:
                CPH.TryGetArg("gameUpdate", out bool TwitchStreamUpdategameUpdate);
                CPH.TryGetArg("statusUpdate", out bool TwitchStreamUpdatestatusUpdate);
                CPH.TryGetArg("gameBoxArt", out string TwitchStreamUpdategameBoxArt);
                CPH.TryGetArg("gameName", out string TwitchStreamUpdategameName);
                CPH.TryGetArg("status", out string TwitchStreamUpdatestatus);
                return $"<strong>Twitch stream Updated</strong>";

            case EventType.TwitchStreamUpdateGameOnConnect:
                return $"<strong>No description provided</strong>";

            case EventType.TwitchSub:
                CPH.TryGetArg("user", out string TwitchSubsubUser);
                CPH.TryGetArg("tier", out string TwitchSubtier);
                CPH.TryGetArg("rawInput", out string TwitchSubrawInput);
                return $"<strong>{TwitchSubsubUser}</strong> subscribed at <span style=\"color:#ff4500\">Tier {TwitchSubtier}</span>";

            case EventType.TwitchSubCounterRollover:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchSuspiciousUserMessage:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchSuspiciousUserUpdate:
                return $"<strong>No description provided</strong>";

            case EventType.TwitchUnbanRequestApproved:
                CPH.TryGetArg("user", out string TwitchUnbanRequestApprovedUser);
                CPH.TryGetArg("moderatorDisplayName", out string TwitchUnbanRequestApprovedModeratorDisplayName);
                CPH.TryGetArg("message", out string TwitchUnbanRequestApprovedMessage);
                return $"<strong>No description provided</strong>";

            case EventType.TwitchUnbanRequestCreated:
                CPH.TryGetArg("user", out string TwitchUnbanRequestCreatedUser);
                CPH.TryGetArg("text", out string TwitchUnbanRequestCreatedText);
                return $"<strong>No description provided</strong>";

            case EventType.TwitchUnbanRequestDenied:
                CPH.TryGetArg("user", out string TwitchUnbanRequestDeniedUser);
                CPH.TryGetArg("moderatorDisplayName", out string TwitchUnbanRequestDeniedModeratorDisplayName);
                CPH.TryGetArg("message", out string TwitchUnbanRequestDeniedMessage);
                return $"<strong>No description provided</strong>";

            case EventType.TwitchUpcomingAd:
                CPH.TryGetArg("triggerName", out string TwitchUpcomingAdTriggerName);                                                               /* The name of the trigger which executed the action */
                CPH.TryGetArg("minutes", out string TwitchUpcomingAdminutes);                                                                       /* The number of minutes until the ad run will start */
                CPH.TryGetArg("snoozesLeft", out string TwitchUpcomingAdSnoozesLeft);                                                               /* The maximum number of snoozes left */
                CPH.TryGetArg("adLength", out string TwitchUpcomingAdLength);                                                                       /* The length of the upcoming ad run, in seconds */
                CPH.TryGetArg("nextAdAt", out string TwitchUpcomingAdNextAdAt);                                                                     /* The exact UTC date and time that the next ad run will start */
                return $"📺 Ad Break in <strong>{TwitchUpcomingAdminutes}</strong> minutes • total: <strong>{TwitchUpcomingAdSnoozesLeft}</strong> snoozes remaining";

            case EventType.TwitchUserBanned:
                CPH.TryGetArg("user", out string TwitchUserBannedUser);
                CPH.TryGetArg("createdByDisplayName", out string TwitchUserBannedcreatedByDisplayName);
                CPH.TryGetArg("reason", out string TwitchUserBannedreason);
                return $"{TwitchUserBannedUser}<strong>banned by</strong> {TwitchUserBannedcreatedByDisplayName} for {TwitchUserBannedreason}";

            case EventType.TwitchUserTimedOut:
                CPH.TryGetArg("user", out string TwitchUserTimedOutUser);
                CPH.TryGetArg("createdByDisplayName", out string TwitchUserTimedOutCreatedByDisplayName);
                CPH.TryGetArg("moderatorDisplayName", out string TwitchUserTimedOutModeratorUserName);
                CPH.TryGetArg("reason", out string TwitchUserTimedOutReason);
                CPH.TryGetArg("duration", out string TwitchUserTimedOutDuration);
                return $"<strong>No description provided</strong>";


            case EventType.TwitchUserUnbanned:
                CPH.TryGetArg("user", out string TwitchUserUnbannedUser);
                CPH.TryGetArg("createdByDisplayName", out string TwitchUserUnbannedCreatedByDisplayName);
                return $"<strong>No description provided</strong>";


            case EventType.TwitchUserUntimedOut:
                CPH.TryGetArg("user", out string TwitchUserUntimedOutUser);
                CPH.TryGetArg("createdByDisplayName", out string TwitchUserUntimedOutCreatedByDisplayName);
                CPH.TryGetArg("moderatorDisplayName", out string TwitchUserUntimedOutModeratorUserName);
                return $"<strong>No description provided</strong>";

            case EventType.TwitchViewerCountUpdate:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchVipAdded:
                return $"<strong>No description provided</strong>";
            case EventType.TwitchVipRemoved:
                return $"<strong>No description provided</strong>";

            case EventType.TwitchWarnedUser:
                CPH.TryGetArg("user", out string TwitchWarnedUserUser);
                CPH.TryGetArg("moderator.userName", out string TwitchWarnedUserModeratorUserName);
                CPH.TryGetArg("reason", out string TwitchWarnedUserReason);
                return $"<strong>No description provided</strong>";

            case EventType.TwitchWarningAcknowledged:
                CPH.TryGetArg("user", out string TwitchWarningAcknowledgedUser);
                return $"<strong>No description provided</strong>";

            case EventType.TwitchWatchStreak:
                CPH.TryGetArg("user", out string TwitchWatchStreakUser);
                CPH.TryGetArg("watchStreak", out decimal TwitchWatchStreak);
                return $"{TwitchWatchStreakUser}<strong> Is at watchstreak level </strong>{TwitchWatchStreak}";

            case EventType.TwitchWhisper:
                return $"<strong>No description provided</strong>";
            // ==================== User Global Variable ========================  
            case EventType.UserGlobalVariableUpdated:
                return $"<strong>No description provided</strong>";
            // ==================== VoiceMod ========================  
            case EventType.VoiceModConnected:
                return $"<strong>No description provided</strong>";
            case EventType.VoiceModDisconnected:
                return $"<strong>No description provided</strong>";
            case EventType.VoiceModSoundboardChanged:
                return $"<strong>No description provided</strong>";
            case EventType.VoiceModVoiceLoaded:
                return $"<strong>No description provided</strong>";
            // ==================== VTube Studio ======================== 
            case EventType.VTubeStudioBackgroundChanged:
                return $"<strong>No description provided</strong>";
            case EventType.VTubeStudioConnected:
                return $"<strong>No description provided</strong>";
            case EventType.VTubeStudioDisconnected:
                return $"<strong>No description provided</strong>";
            case EventType.VTubeStudioHotkeyTriggered:
                return $"<strong>No description provided</strong>";
            case EventType.VTubeStudioItemEvent:
                return $"<strong>No description provided</strong>";
            case EventType.VTubeStudioModelAnimation:
                return $"<strong>No description provided</strong>";
            case EventType.VTubeStudioModelClicked:
                return $"<strong>No description provided</strong>";
            case EventType.VTubeStudioModelConfigChanged:
                return $"<strong>No description provided</strong>";
            case EventType.VTubeStudioModelLoaded:
                return $"<strong>No description provided</strong>";
            case EventType.VTubeStudioModelUnloaded:
                return $"<strong>No description provided</strong>";
            case EventType.VTubeStudioTrackingStatusChanged:
                return $"<strong>No description provided</strong>";
            // ==================== Websocket Client ======================== 
            case EventType.WebsocketClientClose:
                return $"<strong>No description provided</strong>";
            case EventType.WebsocketClientMessage:
                return $"<strong>No description provided</strong>";
            case EventType.WebsocketClientOpen:
                return $"<strong>No description provided</strong>";
            // ==================== Websocket Custom Server ========================                 
            case EventType.WebsocketCustomServerClose:
                return $"<strong>No description provided</strong>";
            case EventType.WebsocketCustomServerMessage:
                return $"<strong>No description provided</strong>";
            case EventType.WebsocketCustomServerOpen:
                return $"<strong>No description provided</strong>";
            // ==================== YouTube ========================                   
            case EventType.YouTubeBetterTTVEmoteAdded:
                return $"<strong>No description provided</strong>";
            case EventType.YouTubeBetterTTVEmoteRemoved:
                return $"<strong>No description provided</strong>";
            case EventType.YouTubeBroadcastAdded:
                return $"<strong>No description provided</strong>";
            case EventType.YouTubeBroadcastEnded:
                return $"<strong>No description provided</strong>";
            case EventType.YouTubeBroadcastMonitoringEnded:
                return $"<strong>No description provided</strong>";
            case EventType.YouTubeBroadcastMonitoringStarted:
                return $"<strong>No description provided</strong>";
            case EventType.YouTubeBroadcastRemoved:
                return $"<strong>No description provided</strong>";
            case EventType.YouTubeBroadcastStarted:
                return $"<strong>No description provided</strong>";
            case EventType.YouTubeBroadcastUpdated:
                return $"<strong>No description provided</strong>";
            case EventType.YouTubeFirstWords:
                return $"<strong>No description provided</strong>";
            case EventType.YouTubeMemberMileStone:
                return $"<strong>No description provided</strong>";

            case EventType.YouTubeMembershipGift:
                CPH.TryGetArg("gifterUser", out string YouTubeMembershipGiftGifterUser);
                CPH.TryGetArg("user", out string YouTubeMembershipGiftUser);
                CPH.TryGetArg("userId", out string YouTubeMembershipGiftUserId);
                CPH.TryGetArg("tier", out string YouTubeMembershipGiftTier);
                CPH.TryGetArg("userProfileUrl", out string YouTubeMembershipGiftUserProfileUrl);
                return $"<strong>No description provided</strong>";

            case EventType.YouTubeGiftMembershipReceived:
                CPH.TryGetArg("gifterUser", out string YouTubeGiftMembershipReceivedGifterUser);
                CPH.TryGetArg("user", out string YouTubeGiftMembershipReceivedUser);
                CPH.TryGetArg("userId", out string YouTubeGiftMembershipReceivedUserId);
                CPH.TryGetArg("tier", out string YouTubeGiftMembershipReceivedTier);
                CPH.TryGetArg("userProfileUrl", out string YouTubeGiftMembershipReceivedUserProfileUrl);
                return $"<strong>No description provided</strong>";

            case EventType.YouTubeMessage:
                CPH.TryGetArg("message", out string YouTubeMessagemessage);
                CPH.TryGetArg("user", out string YouTubeMessageuser);
                CPH.TryGetArg("userId", out string YouTubeMessageuserId);
                CPH.TryGetArg("userProfileUrl", out string YouTubeMessageuserProfileUrl);
                return $"{YouTubeMessageuser}<strong>say</strong> {YouTubeMessagemessage}";


            case EventType.YouTubeMessageDeleted:
                return $"<strong>No description provided</strong>";

            case EventType.YouTubeNewSponsor:
                CPH.TryGetArg("user", out string YouTubeNewSponsorUser);
                CPH.TryGetArg("userId", out string YouTubeNewSponsorUserId);
                CPH.TryGetArg("levelName", out string YouTubeNewSponsorLevelName);
                CPH.TryGetArg("userProfileUrl", out string YouTubeNewSponsorUserProfileUrl);
                return $"<strong>No description provided</strong>";

            case EventType.YouTubeNewSponsorOnlyEnded:
                return $"<strong>No description provided</strong>";
            case EventType.YouTubeNewSponsorOnlyStarted:
                return $"<strong>No description provided</strong>";

            case EventType.YouTubeNewSubscriber:
                CPH.TryGetArg("user", out string YouTubeNewSubscriberUser);
                CPH.TryGetArg("userId", out string YouTubeNewSubscriberUserId);
                CPH.TryGetArg("userProfileUrl", out string YouTubeNewSubscriberUserProfileUrl);
                return $"<strong>No description provided</strong>";

            case EventType.YouTubePollClosed:
                return $"<strong>No description provided</strong>";
            case EventType.YouTubePollStarted:
                return $"<strong>No description provided</strong>";
            case EventType.YouTubePollUpdated:
                return $"<strong>No description provided</strong>";
            case EventType.YouTubePresentViewers:
                return $"<strong>No description provided</strong>";
            case EventType.YouTubeSevenTVEmoteAdded:
                return $"<strong>No description provided</strong>";
            case EventType.YouTubeSevenTVEmoteRemoved:
                return $"<strong>No description provided</strong>";
            case EventType.YouTubeStatisticsUpdated:
                return $"<strong>No description provided</strong>";

            case EventType.YouTubeSuperChat:
                CPH.TryGetArg("user", out string YouTubeSuperChatUser);
                CPH.TryGetArg("userId", out string YouTubeSuperChatUserId);
                CPH.TryGetArg("amount", out string YouTubeSuperChatAmount);
                CPH.TryGetArg("userProfileUrl", out string YouTubeSuperChatUserProfileUrl);
                CPH.TryGetArg("message", out string YouTubeSuperChatMessage);
                return $"<strong>No description provided</strong>";

            case EventType.YouTubeSuperSticker:
                CPH.TryGetArg("user", out string YouTubeSuperStickerUser);
                CPH.TryGetArg("userId", out string YouTubeSuperStickerUserId);
                CPH.TryGetArg("amount", out string YouTubeSuperStickerAmount);
                CPH.TryGetArg("userProfileUrl", out string YouTubeSuperStickerUserProfileUrl);
                CPH.TryGetArg("message", out string YouTubeSuperStickerMessage);
                return $"<strong>No description provided</strong>";

            case EventType.YouTubeUserBanned:
                CPH.TryGetArg("user", out string YouTubeUserBannedUser);
                CPH.TryGetArg("userId", out string YouTubeUserBannedUserId);
                CPH.TryGetArg("banType", out string YouTubeUserBannedBanType);
                CPH.TryGetArg("banDuration", out int YouTubeUserBannedBanDuration);
                return $"<strong>No description provided</strong>";

            case EventType.CustomCodeEvent:
                {
                    CPH.TryGetArg("triggerCustomCodeEventName", out string triggerCustomCodeEventName);

                    /////////////////////
                    // KICK.BOT EVENTS //
                    /////////////////////

                    switch (triggerCustomCodeEventName)
                    {
                        case "kickUnban":
                            {
                                CPH.TryGetArg("user", out string kickUnbanUser);
                                CPH.TryGetArg("deletedByDisplayName", out string kickUnbanDeletedByDisplayName);
                                return $"<strong>No description provided</strong>";
                            }

                        case "kickRewardRedeemed":
                            {
                                CPH.TryGetArg("user", out string kickRewardRedeemedUser);
                                CPH.TryGetArg("rewardTitle", out string kickRewardRedeemedRewardTitle);
                                CPH.TryGetArg("rewardUserInput", out string kickRewardRedeemedRewardUserInput);
                                return $"<strong>No description provided</strong>";
                            }

                        case "kickIncomingRaid":
                            {
                                CPH.TryGetArg("user", out string user);
                                CPH.TryGetArg("viewers", out int viewers);
                                return $"<strong>No description provided</strong>";
                            }

                            case "kickChatMessage":
                            {
                                CPH.TryGetArg("user", out string user);
                                CPH.TryGetArg("message", out string message);
                                return $"<strong>No description provided</strong>";
                            }    

                        case "kickChatMessageDeleted":
                            {
                                CPH.TryGetArg("user", out string user);
                                CPH.TryGetArg("message", out string message);
                                return $"<strong>No description provided</strong>";
                            }

                        case "kickMessagePinned":
                            {
                                CPH.TryGetArg("user", out string user);
                                CPH.TryGetArg("userName", out string userName);
                                CPH.TryGetArg("message", out string message);
                                return $"<strong>No description provided</strong>";
                            }

                        case "kickMessageUnpinned":
                            {
                                CPH.TryGetArg("isTest", out string kickMessageUnpinnedisTest);
                                return $"<strong>No description provided</strong>";
                            }

                        case "kickPollCreated":
                            {
                                CPH.TryGetArg("poll.Title", out string title);
                                CPH.TryGetArg("poll.Duration", out int duration);
                                CPH.TryGetArg("poll.choices.count", out int choiceCount);

                                // Construct a list of choices
                                List<JObject> choices = new List<JObject>();
                                for (int i = 0; i < choiceCount; i++)
                                {
                                    JObject choice = new JObject();
                                    CPH.TryGetArg($"poll.choice{i}.title", out string choiceTitle);
                                    choice["title"] = choiceTitle;
                                    choices.Add(choice);
                                }
                                return $"<strong>No description provided</strong>";
                            }

                        case "kickPollCompleted":
                            {
                                CPH.TryGetArg("poll.Title", out string title);
                                CPH.TryGetArg("poll.choices.count", out int choiceCount);
                                CPH.TryGetArg("poll.winningChoice.title", out string winningChoiceTitle);
                                CPH.TryGetArg("poll.totalVotes", out int totalVotes);

                                List<JObject> choices = new List<JObject>();
                                for (int i = 0; i < choiceCount; i++)
                                {
                                    JObject choice = new JObject();
                                    CPH.TryGetArg($"poll.choice{i}.title", out string choiceTitle);
                                    CPH.TryGetArg($"poll.choice{i}.totalVotes", out int choiceVotes);
                                    choice["title"] = choiceTitle;
                                    choice["totalVotes"] = choiceVotes;
                                    choices.Add(choice);
                                }
                                return $"<strong>No description provided</strong>";
                            }

                        case "kickPredictionCreated":
                            {
                                CPH.TryGetArg("predictionTitle", out string title);
                                CPH.TryGetArg("predictionDuration", out int predictionDuration);

                                List<JObject> outcomes = new List<JObject>();
                                for (int i = 0; i < 10; i++)
                                {
                                    JObject outcome = new JObject();
                                    CPH.TryGetArg($"predictionOutcome{i}Id", out string outcomeID);
                                    if (string.IsNullOrEmpty(outcomeID))
                                        break;
                                    CPH.TryGetArg($"predictionOutcome{i}Title", out string outcomeTitle);
                                    outcome["id"] = outcomeID;
                                    outcome["title"] = outcomeTitle;
                                    outcomes.Add(outcome);
                                }
                                return $"<strong>No description provided</strong>";
                            }

                        case "kickPredictionResolved":
                            {
                                CPH.TryGetArg("predictionTitle", out string title);
                                int totalVoteAmount = 0;

                                List<JObject> outcomes = new List<JObject>();
                                for (int i = 0; i < 10; i++)
                                {
                                    JObject outcome = new JObject();
                                    CPH.TryGetArg($"predictionOutcome{i}Id", out string outcomeID);
                                    if (string.IsNullOrEmpty(outcomeID))
                                        break;

                                    CPH.TryGetArg($"predictionOutcome{i}Title", out string outcomeTitle);
                                    CPH.TryGetArg($"predictionOutcome{i}TotalVoteAmount", out int outcomeTotalVoteAmount);
                                    outcome["id"] = outcomeID;
                                    outcome["title"] = outcomeTitle;
                                    outcome["totalVoteAmount"] = outcomeTotalVoteAmount;
                                    outcomes.Add(outcome);
                                    totalVoteAmount += outcomeTotalVoteAmount;
                                }
                                return $"<strong>No description provided</strong>";
                            }
                        default:
                            return $"Custom Event triggered: {triggerCustomCodeEventName}";
                    }
                }
        }
        return "";
    }


    // REMOVED GetRawEventData() - no longer needed

    public void GenerateLiveHTML(string htmlPath, List<EventData> events)
    {
        StringBuilder html = new StringBuilder();
        html.AppendLine("<!DOCTYPE html>");
        html.AppendLine("<html>");
        html.AppendLine("<head>");
        html.AppendLine("    <meta charset=\"UTF-8\">");
        html.AppendLine("    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">");
        html.AppendLine("    <title>🔴 Live Events</title>");
        html.AppendLine("    <style>");
        html.AppendLine("        * { margin: 0; padding: 0; box-sizing: border-box; }");
        html.AppendLine("        body { font-family: 'Segoe UI', sans-serif; background: #0e0e10; color: #efeff1; padding: 20px; }");
        html.AppendLine("        .container { max-width: 1600px; margin: 0 auto; }");
        html.AppendLine("        h1 { color: #9147ff; margin-bottom: 10px; font-size: 2em; }");
        html.AppendLine("        .header { background: #18181b; padding: 20px; border-radius: 8px; margin-bottom: 20px; }");
        html.AppendLine("        .nav { display: flex; gap: 15px; margin-top: 15px; }");
        html.AppendLine("        .nav a { background: #9147ff; color: white; padding: 10px 20px; border-radius: 6px; text-decoration: none; font-weight: bold; transition: 0.2s; }");
        html.AppendLine("        .nav a:hover { background: #772ce8; }");
        html.AppendLine("        .info { color: #adadb8; font-size: 0.95em; }");
        html.AppendLine("        .event { background: #18181b; padding: 15px; margin: 10px 0; border-left: 4px solid #9147ff; border-radius: 4px; animation: fadeIn 0.5s; }");
        html.AppendLine("        @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }");
        html.AppendLine("        .timestamp { color: #adadb8; margin-right: 10px; font-family: monospace; }");
        html.AppendLine("        .source { color: #efeff1; font-weight: bold; margin-right: 10px; display: inline-block; min-width: 180px; }");

        // Dynamic platform CSS
        html.Append(GetPlatformCSS());

        html.AppendLine("        .live-indicator { display: inline-block; width: 10px; height: 10px; background: #ff0000; border-radius: 50%; animation: pulse 2s infinite; margin-right: 8px; }");
        html.AppendLine("        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.3; } }");
        html.AppendLine("    </style>");
        html.AppendLine("</head>");
        html.AppendLine("<body>");
        html.AppendLine("    <div class=\"container\">");
        html.AppendLine("        <div class=\"header\">");
        html.AppendLine("            <h1><span class=\"live-indicator\"></span>Live Event Feed</h1>");
        html.AppendLine("            <div class=\"info\">");
        html.AppendLine($"                Last updated: {DateTime.Now:yyyy-MM-dd HH:mm:ss} | Auto-refresh: {refreshSeconds}s | Showing last {liveDisplayEvents} events");
        html.AppendLine("            </div>");
        html.AppendLine("            <div class=\"nav\">");
        html.AppendLine("                <a href=\"index.html\">📚 View All Archives</a>");
        html.AppendLine($"                <a href=\"Archives/{DateTime.Now:yyyy-MM-dd}.html\">📅 Today's Full Log</a>");
        html.AppendLine("            </div>");
        html.AppendLine("        </div>");

        // Correct event loop with shortened source
        for (int i = events.Count - 1; i >= 0; i--)
        {
            var evt = events[i];
            string platform = GetPlatform(evt.Source);
            string shortSource = ShortenEventSource(evt.Source); // ADDED THIS LINE

            html.AppendLine($"        <div class=\"event {evt.Source}\" data-platform=\"{platform}\">");
            html.AppendLine($"            <span class=\"timestamp\">{evt.Timestamp:HH:mm:ss}</span>");
            html.AppendLine($"            <span class=\"source\">{shortSource}</span>"); // CHANGED THIS LINE
            html.AppendLine($"            <span class=\"details\">{evt.Details}</span>");
            html.AppendLine("        </div>");
        }

        html.AppendLine("    </div>");
        html.AppendLine("    <script>");
        html.AppendLine($"        setTimeout(() => location.reload(), {refreshSeconds * 1000});");
        html.AppendLine("    </script>");
        html.AppendLine("</body>");
        html.AppendLine("</html>");

        File.WriteAllText(htmlPath, html.ToString());
    }

    public void GenerateArchiveHTML(string htmlPath, List<EventData> events, string date)
    {
        // Extract platforms from event sources (e.g., "TwitchCheer" -> "Twitch")
        var platforms = events.Select(e => GetPlatform(e.Source)).Distinct().OrderBy(p => p).ToList();

        // Count event types
        var eventCounts = events.GroupBy(e => e.Source).ToDictionary(g => g.Key, g => g.Count());

        StringBuilder html = new StringBuilder();
        html.AppendLine("<!DOCTYPE html>");
        html.AppendLine("<html>");
        html.AppendLine("<head>");
        html.AppendLine("    <meta charset=\"UTF-8\">");
        html.AppendLine("    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">");
        html.AppendLine($"    <title>Archive: {date}</title>");
        html.AppendLine("    <style>");
        html.AppendLine("        * { margin: 0; padding: 0; box-sizing: border-box; }");
        html.AppendLine("        body { font-family: 'Segoe UI', sans-serif; background: #0e0e10; color: #efeff1; padding: 20px; }");
        html.AppendLine("        .container { max-width: 1400px; margin: 0 auto; }");
        html.AppendLine("        h1 { color: #9147ff; margin-bottom: 20px; }");
        html.AppendLine("        .header { background: #18181b; padding: 20px; border-radius: 8px; margin-bottom: 20px; }");
        html.AppendLine("        .nav { display: flex; gap: 15px; margin-top: 15px; }");
        html.AppendLine("        .nav a { background: #9147ff; color: white; padding: 10px 20px; border-radius: 6px; text-decoration: none; font-weight: bold; transition: 0.2s; }");
        html.AppendLine("        .nav a:hover { background: #772ce8; }");
        html.AppendLine("        .stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0; }");
        html.AppendLine("        .stat-card { background: #1f1f23; padding: 15px; border-radius: 8px; border-left: 4px solid #9147ff; }");
        html.AppendLine("        .stat-label { color: #adadb8; font-size: 0.9em; }");
        html.AppendLine("        .stat-value { color: #9147ff; font-size: 2em; font-weight: bold; }");
        html.AppendLine("        .search-box { background: #18181b; padding: 15px; border-radius: 8px; margin-bottom: 20px; }");
        html.AppendLine("        .search-input { width: 100%; padding: 12px; background: #0e0e10; border: 2px solid #9147ff; border-radius: 6px; color: #efeff1; font-size: 1em; }");
        html.AppendLine("        .filter-buttons { display: flex; gap: 10px; margin-top: 10px; flex-wrap: wrap; }");
        html.AppendLine("        .filter-btn { padding: 8px 16px; background: #1f1f23; border: 2px solid #9147ff; border-radius: 6px; color: #efeff1; cursor: pointer; transition: 0.2s; }");
        html.AppendLine("        .filter-btn:hover, .filter-btn.active { background: #9147ff; }");
        html.AppendLine("        .event { background: #18181b; padding: 15px; margin: 10px 0; border-left: 4px solid #9147ff; border-radius: 4px; }");
        html.AppendLine("        .event.hidden { display: none; }");
        html.AppendLine("        .timestamp { color: #adadb8; margin-right: 10px; font-family: monospace; }");
        html.AppendLine("        .source { color: #9147ff; font-weight: bold; margin-right: 10px; display: inline-block; min-width: 180px; }");

        // --- NEW: Dynamic Platform CSS using data-platform attributes ---
        html.Append(GetPlatformCSS());
        // ---------------------------------------------------------------

        html.AppendLine("    </style>");
        html.AppendLine("</head>");
        html.AppendLine("<body>");
        html.AppendLine("    <div class=\"container\">");
        html.AppendLine("        <div class=\"header\">");
        html.AppendLine($"            <h1>📅 Archive: {date}</h1>");
        html.AppendLine($"            <p>Total Events: {events.Count}</p>");
        html.AppendLine("            <div class=\"nav\">");
        html.AppendLine("                <a href=\"../live.html\">🔴 Back to Live</a>");
        html.AppendLine("                <a href=\"../index.html\">📚 All Archives</a>");
        html.AppendLine("            </div>");
        html.AppendLine("        </div>");

        // Stats cards
        html.AppendLine("        <div class=\"stats\">");
        foreach (var kvp in eventCounts.OrderByDescending(x => x.Value))
        {
            html.AppendLine("            <div class=\"stat-card\">");
            html.AppendLine($"                <div class=\"stat-label\">{kvp.Key}</div>");
            html.AppendLine($"                <div class=\"stat-value\">{kvp.Value}</div>");
            html.AppendLine("            </div>");
        }
        html.AppendLine("        </div>");

        // Search and filter
        html.AppendLine("        <div class=\"search-box\">");
        html.AppendLine("            <input type=\"text\" id=\"searchInput\" class=\"search-input\" placeholder=\"Search events...\" onkeyup=\"searchEvents()\">");
        html.AppendLine("            <div class=\"filter-buttons\">");
        html.AppendLine("                <button class=\"filter-btn active\" onclick=\"filterByPlatform('all')\">All Platforms</button>");
        foreach (var platform in platforms)
        {
            html.AppendLine($"                <button class=\"filter-btn\" onclick=\"filterByPlatform('{platform}')\">{platform}</button>");
        }
        html.AppendLine("            </div>");
        html.AppendLine("        </div>");

        // Events - with shortened source
        html.AppendLine("        <div id=\"eventsContainer\">");
        for (int i = events.Count - 1; i >= 0; i--)
        {
            EventData evt = events[i];
            string platform = GetPlatform(evt.Source);
            string shortSource = ShortenEventSource(evt.Source); // ADDED THIS LINE
            
            html.AppendLine($"        <div class=\"event {evt.Source}\" data-platform=\"{platform}\" data-source=\"{evt.Source}\" data-search=\"{StripHtml(evt.Details).ToLower()}\">");
            html.AppendLine($"            <span class=\"timestamp\">{evt.Timestamp:HH:mm:ss}</span>");
            html.AppendLine($"            <span class=\"source\">{shortSource}</span>"); // CHANGED THIS LINE
            html.AppendLine($"            <span class=\"details\">{evt.Details}</span>");
            html.AppendLine("        </div>");
        }
        html.AppendLine("        </div>");

        // JavaScript for search and filter
        html.AppendLine("    </div>");
        html.AppendLine("    <script>");
        html.AppendLine("        let currentPlatform = 'all';");
        html.AppendLine("        function searchEvents() {");
        html.AppendLine("            const search = document.getElementById('searchInput').value.toLowerCase();");
        html.AppendLine("            const events = document.querySelectorAll('.event');");
        html.AppendLine("            events.forEach(event => {");
        html.AppendLine("                const searchData = event.getAttribute('data-search');");
        html.AppendLine("                const platform = event.getAttribute('data-platform');");
        html.AppendLine("                const matchesSearch = searchData.includes(search);");
        html.AppendLine("                const matchesPlatform = currentPlatform === 'all' || platform === currentPlatform;");
        html.AppendLine("                event.classList.toggle('hidden', !(matchesSearch && matchesPlatform));");
        html.AppendLine("            });");
        html.AppendLine("        }");
        html.AppendLine("        function filterByPlatform(platform) {");
        html.AppendLine("            currentPlatform = platform;");
        html.AppendLine("            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));");
        html.AppendLine("            event.target.classList.add('active');");
        html.AppendLine("            searchEvents();");
        html.AppendLine("        }");
        html.AppendLine("    </script>");
        html.AppendLine("</body>");
        html.AppendLine("</html>");

        File.WriteAllText(htmlPath, html.ToString());
    }

    public void GenerateIndexHTML(string indexPath, string htmlFolderPath)
    {
        string archivesDir = $"{htmlFolderPath}\\Archives";
        if (!Directory.Exists(archivesDir))
            return;

        var archiveFiles = Directory.GetFiles(archivesDir, "*.json")
            .Select(f => new FileInfo(f))
            .OrderByDescending(f => f.Name)
            .ToList();

        StringBuilder html = new StringBuilder();
        html.AppendLine("<!DOCTYPE html>");
        html.AppendLine("<html>");
        html.AppendLine("<head>");
        html.AppendLine("    <meta charset=\"UTF-8\">");
        html.AppendLine("    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">");
        html.AppendLine("    <title>Event Archives</title>");
        html.AppendLine("    <style>");
        html.AppendLine("        * { margin: 0; padding: 0; box-sizing: border-box; }");
        html.AppendLine("        body { font-family: 'Segoe UI', sans-serif; background: #0e0e10; color: #efeff1; padding: 20px; }");
        html.AppendLine("        .container { max-width: 1400px; margin: 0 auto; }");
        html.AppendLine("        h1 { color: #9147ff; margin-bottom: 30px; }");
        html.AppendLine("        .nav { margin-bottom: 30px; }");
        html.AppendLine("        .nav a { background: #9147ff; color: white; padding: 12px 24px; border-radius: 6px; text-decoration: none; font-weight: bold; transition: 0.2s; display: inline-block; }");
        html.AppendLine("        .nav a:hover { background: #772ce8; }");
        html.AppendLine("        .archive-list { display: grid; gap: 15px; }");
        html.AppendLine("        .archive-item { background: #18181b; padding: 20px; border-radius: 8px; border-left: 4px solid #9147ff; display: flex; justify-content: space-between; align-items: center; transition: 0.2s; }");
        html.AppendLine("        .archive-item:hover { background: #1f1f23; transform: translateX(5px); }");
        html.AppendLine("        .archive-date { color: #9147ff; font-size: 1.3em; font-weight: bold; }");
        html.AppendLine("        .archive-info { color: #adadb8; font-size: 0.9em; }");
        html.AppendLine("        .archive-link { background: #9147ff; color: white; padding: 10px 20px; border-radius: 6px; text-decoration: none; font-weight: bold; transition: 0.2s; }");
        html.AppendLine("        .archive-link:hover { background: #772ce8; }");
        html.AppendLine("    </style>");
        html.AppendLine("</head>");
        html.AppendLine("<body>");
        html.AppendLine("    <div class=\"container\">");
        html.AppendLine("        <h1>📚 Event Archives</h1>");
        html.AppendLine("        <div class=\"nav\">");
        html.AppendLine("            <a href=\"live.html\">🔴 Back to Live Feed</a>");
        html.AppendLine("        </div>");
        html.AppendLine("        <div class=\"archive-list\">");

        foreach (var file in archiveFiles)
        {
            string fileName = Path.GetFileNameWithoutExtension(file.Name);
            string date = fileName.Replace("_events", "");
            List<EventData> events = LoadEvents(file.FullName);

            html.AppendLine("            <div class=\"archive-item\">");
            html.AppendLine("                <div>");
            html.AppendLine($"                    <div class=\"archive-date\">{date}</div>");
            html.AppendLine($"                    <div class=\"archive-info\">{events.Count} events • {file.Length / 1024}KB</div>");
            html.AppendLine("                </div>");
            html.AppendLine($"                <a href=\"Archives/{date}.html\" class=\"archive-link\">View Archive →</a>");
            html.AppendLine("            </div>");
        }

        html.AppendLine("        </div>");
        html.AppendLine("    </div>");
        html.AppendLine("</body>");
        html.AppendLine("</html>");

        File.WriteAllText(indexPath, html.ToString());
    }

    // Helper method to dynamically generate platform-specific CSS
    private string GetPlatformCSS()
    {
        var platformColors = new Dictionary<string, string>
    {
        // Core Platforms
        { "Twitch", "#9146FF" },
        { "Kick", "#00E701" },
        { "YouTube", "#FF0000" },
        
        // Integrations / Other
        { "Discord", "#5865F2" },
        { "Patreon", "#FF424D" },
        { "Kofi", "#FF5E5B" },
        { "Pally", "#00D4FF" },
        { "StreamElements", "#0FBEAA" },
        { "Streamlabs", "#80F5D2" },
        { "MeldStudio", "#6B52FF" },
        { "CrowdControl", "#FFD700" },
        { "DonorDrive", "#4A90E2" },
        { "ElgatoCamera", "#0D7EE5" },
        { "ElgatoWave", "#0D7EE5" },
        { "Fourthwall", "#000000" },
        { "HypeRate", "#E91E63" },
        { "Pulsoid", "#FF4081" },
        { "Shopify", "#96BF48" },
        { "SpeakerBot", "#9C27B0" },
        { "SpeechToText", "#E69138" },
        { "StreamDeck", "#0D7EE5" },
        { "ThrowingSystem", "#333333" },
        { "TipeeeStream", "#FF6B6B" },
        { "TreatStream", "#FFA500" },
        { "Trovo", "#00E600" },
        { "TikTok", "#EE1D52" },
        
        // Catch-all 
        { "Obs", "#302E31" }, // Separate Obs for custom text color
        { "Other", "#FF5C39" }
    };

        StringBuilder css = new StringBuilder();
        foreach (var platform in platformColors)
        {
            // Set border color
            css.AppendLine($"        .event[data-platform='{platform.Key}'] {{ border-left-color: {platform.Value}; }}");
            // Set source text color
            css.AppendLine($"        .event[data-platform='{platform.Key}'] .source {{ color: {platform.Value}; }}");
        }

        // Override 'Obs' and 'Fourthwall' source text color for better contrast on a dark background
        css.AppendLine("        .event[data-platform='Obs'] .source { color: #FFFFFF; }");
        css.AppendLine("        .event[data-platform='Fourthwall'] .source { color: #FFFFFF; }");

        return css.ToString();
    }

    // Helper method for HTML encoding
    private string HtmlEncode(string text)
    {
        if (string.IsNullOrEmpty(text)) return text;

        return text.Replace("&", "&amp;")
                    .Replace("<", "&lt;")
                    .Replace(">", "&gt;")
                    .Replace("\"", "&quot;")
                    .Replace("'", "&#39;");
    }

    // Helper method to extract platform from source (e.g., "TwitchCheer" -> "Twitch")
    private string GetPlatform(string source)
    {
        if (source.StartsWith("CrowdControl")) return "CrowdControl";
        if (source.StartsWith("Discord")) return "Discord";
        if (source.StartsWith("DonorDrive")) return "DonorDrive";
        if (source.StartsWith("ElgatoCamera")) return "ElgatoCamera";
        if (source.StartsWith("ElgatoWave")) return "ElgatoWave";
        if (source.StartsWith("Fourthwall")) return "Fourthwall";
        if (source.StartsWith("HypeRate")) return "HypeRate";
        if (source.StartsWith("Kick")) return "Kick";
        if (source.StartsWith("Kofi")) return "Kofi";
        if (source.StartsWith("MeldStudio")) return "MeldStudio";
        if (source.StartsWith("Obs")) return "ObsStudio";
        if (source.StartsWith("Pally")) return "Pally";
        if (source.StartsWith("Patreon")) return "Patreon";
        if (source.StartsWith("Pulsoid")) return "Pulsoid";
        if (source.StartsWith("Shopify")) return "Shopify";
        if (source.StartsWith("SpeakerBot")) return "SpeakerBot";
        if (source.StartsWith("SpeechToText")) return "SpeechToText";
        if (source.StartsWith("StreamDeck")) return "StreamDeck";
        if (source.StartsWith("StreamElements")) return "StreamElements";
        if (source.StartsWith("Streamlabs")) return "Streamlabs";
        if (source.StartsWith("ThrowingSystem")) return "ThrowingSystem";
        if (source.StartsWith("TipeeeStream")) return "TipeeeStream";
        if (source.StartsWith("TreatStream")) return "TreatStream";
        if (source.StartsWith("Trovo")) return "Trovo";
        if (source.StartsWith("TikTok")) return "TikTok";
        if (source.StartsWith("Twitch")) return "Twitch";
        if (source.StartsWith("YouTube")) return "YouTube";
        return "Other";
    }

    // Helper method to strip HTML tags for search
    private string StripHtml(string html)
    {
        if (string.IsNullOrEmpty(html)) return "";
        return System.Text.RegularExpressions.Regex.Replace(html, "<.*?>", "");
    }
}

public class EventData
{
    public DateTime Timestamp { get; set; }
    public string Source { get; set; }
    public string Details { get; set; }
    public string RawData { get; set; }
}
